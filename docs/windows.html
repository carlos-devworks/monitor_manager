<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.1" />
<title>screen_brightness_control.windows API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>screen_brightness_control.windows</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import wmi, threading, pythoncom, ctypes, win32api
from ctypes import windll, byref, Structure, WinError, POINTER, WINFUNCTYPE
from ctypes.wintypes import BOOL, HMONITOR, HDC, RECT, LPARAM, DWORD, BYTE, WCHAR, HANDLE
from . import flatten_list, _monitor_brand_lookup

class WMI:
    &#39;&#39;&#39;collection of screen brightness related methods using the WMI API&#39;&#39;&#39;
    def _get_display_index(display, *args):
        &#39;&#39;&#39;internal function, do not call&#39;&#39;&#39;
        if len(args)==1:
            info = args[0]
        else:
            info = WMI.get_display_info()
        a = 0
        for i in info:
            if display in (i[&#39;serial&#39;], i[&#39;model&#39;], i[&#39;name&#39;]):
                return a
            a+=1
        return None
    def get_display_info(*args):
        &#39;&#39;&#39;
        Returns a dictionary of info about all detected monitors

        Args:
            monitor (str or int): [*Optional*] the monitor to return info about. Pass in the serial number, name, model or index

        Returns:
            list: list of dictonaries
            dict: one dictionary if a monitor is specified

        Example:
            ```python
            import screen_brightness_control as sbc

            info = sbc.windows.WMI.get_display_info()
            for i in info:
                print(&#39;================&#39;)
                for key, value in i.items():
                    print(key, &#39;:&#39;, value)

            # get information about the first WMI addressable monitor
            primary_info = sbc.windows.WMI.get_display_info(0)

            # get information about a monitor with a specific name
            benq_info = sbc.windows.WMI.get_display_info(&#39;BenQ BNQ78A7&#39;)
            ```
        &#39;&#39;&#39;
        #WMI calls don&#39;t work in new threads so we have to run this check
        if threading.current_thread() != threading.main_thread():
            pythoncom.CoInitialize()
        info = []
        a = 0
        try:
            monitors = wmi.WMI(namespace=&#39;wmi&#39;).WmiMonitorBrightness()
            for m in monitors:
                instance = m.InstanceName.split(&#39;\\&#39;)
                serial = instance[-1]
                model = instance[1]

                man_id = model[:3]
                manufacturer = _monitor_brand_lookup(man_id)
                manufacturer = &#39;Unknown&#39; if manufacturer==None else manufacturer

                tmp = {&#39;name&#39;:f&#39;{manufacturer} {model}&#39;, &#39;model&#39;:model, &#39;model_name&#39;: None, &#39;serial&#39;:serial, &#39;manufacturer&#39;: manufacturer, &#39;manufacturer_id&#39;: man_id , &#39;index&#39;: a, &#39;method&#39;: WMI}
                info.append(tmp)
                a+=1
        except:
            pass
        if len(args)==1:
            index = WMI._get_display_index(args[0], info)
            if index==None:
                raise LookupError(&#39;display not in list&#39;)
            else:
                info = info[index]
        return info
    def get_display_names():
        &#39;&#39;&#39;
        Returns names of all displays that can be addressed by WMI

        Returns:
            list: list of strings

        Example:
            ```python
            import screen_brightness_control as sbc

            for name in sbc.windows.WMI.get_display_names():
                print(name)
            ```
        &#39;&#39;&#39;
        info = WMI.get_display_info()
        names = [i[&#39;name&#39;] for i in info]
        return names
    def set_brightness(value, display = None, no_return = False):
        &#39;&#39;&#39;
        Sets the display brightness for Windows using WMI

        Args:
            value (int): The percentage to set the brightness to
            display (int or str): The index display you wish to set the brightness for OR the model of the display, as returned by self.get_display_names
            no_return (bool): if True, this function returns None, otherwise it returns the result of `WMI.get_brightness()`

        Returns:
            int: from 0 to 100 if only one display&#39;s brightness is requested
            list: list of integers if multiple displays are requested
            None: if `no_return` is set to `True`

        Raises:
            LookupError: if the given display cannot be found

        Example:
            ```python
            import screen_brightness_control as sbc

            # set brightness of WMI addressable monitors to 50%
            sbc.windows.WMI.set_brightness(50)

            # set the primary display brightness to 75%
            sbc.windows.WMI.set_brightness(75, display = 0)

            # set the brightness of a named monitor to 25%
            sbc.windows.WMI.set_brightness(25, display = &#39;BenQ BNQ78A7&#39;)
            ```
        &#39;&#39;&#39;
        #WMI calls don&#39;t work in new threads so we have to run this check
        if threading.current_thread() != threading.main_thread():
            pythoncom.CoInitialize()

        brightness_method = wmi.WMI(namespace=&#39;wmi&#39;).WmiMonitorBrightnessMethods()
        if display!=None:
            if type(display) is str:
                display = WMI._get_display_index(display)
                if display == None:
                    raise LookupError(&#39;display name not found&#39;)
            brightness_method = [brightness_method[display]]
        for method in brightness_method:
            method.WmiSetBrightness(value,0)
        return WMI.get_brightness(display=display) if not no_return else None
    def get_brightness(display = None):
        &#39;&#39;&#39;
        Returns the current display brightness using the `wmi` API

        Args:
            display (int): The index display you wish to get the brightness of OR the model of that display

        Returns:
            int: from 0 to 100 if only one display&#39;s brightness is requested
            list: list of integers if multiple displays are requested

        Raises:
            LookupError: if the given display cannot be found

        Example:
            ```python
            import screen_brightness_control as sbc

            # get brightness of all WMI addressable monitors
            current_brightness = sbc.windows.WMI.get_brightness()
            if type(current_brightness) is int:
                print(&#39;There is only one detected display&#39;)
            else:
                print(&#39;There are&#39;, len(current_brightness), &#39;detected displays&#39;)

            # get the primary display brightness
            primary_brightness = sbc.windows.WMI.get_brightness(display = 0)

            # get the brightness of a named monitor
            benq_brightness = sbc.windows.WMI.get_brightness(display = &#39;BenQ BNQ78A7&#39;)
            ```
        &#39;&#39;&#39;
        #WMI calls don&#39;t work in new threads so we have to run this check
        if threading.current_thread() != threading.main_thread():
            pythoncom.CoInitialize()
        brightness_method = wmi.WMI(namespace=&#39;wmi&#39;).WmiMonitorBrightness()
        values = [i.CurrentBrightness for i in brightness_method]
        if display!=None:
            if type(display) is str:
                display = WMI._get_display_index(display)
                if display == None:
                    raise LookupError(&#39;display name not found&#39;)
            values = [values[display]]
        values = values[0] if len(values)==1 else values
        return values

class VCP:
    &#39;&#39;&#39;Collection of screen brightness related methods using the DDC/CI commands&#39;&#39;&#39;
    _MONITORENUMPROC = WINFUNCTYPE(BOOL, HMONITOR, HDC, POINTER(RECT), LPARAM)
    class _PHYSICAL_MONITOR(Structure):
        &#39;&#39;&#39;internal class, do not call&#39;&#39;&#39;
        _fields_ = [(&#39;handle&#39;, HANDLE),
                    (&#39;description&#39;, WCHAR * 128)]

    def iter_physical_monitors():
        &#39;&#39;&#39;
        A generator to iterate through all physical monitors and then close them again afterwards, yielding their handles.
        It is not recommended to use this function unless you are familiar with `ctypes` and `windll`

        Raises:
            ctypes.WinError: upon failure to enumerate through the monitors

        Example:
            ```python
            import screen_brightness_control as sbc

            for monitor in sbc.windows.VCP.iter_physical_monitors():
                print(sbc.windows.VCP.get_monitor_caps(monitor))
            ```
        &#39;&#39;&#39;
        def callback(hmonitor, hdc, lprect, lparam):
            monitors.append(HMONITOR(hmonitor))
            return True

        monitors = []
        if not windll.user32.EnumDisplayMonitors(None, None, VCP._MONITORENUMPROC(callback), None):
            raise WinError(&#39;EnumDisplayMonitors failed&#39;)
        for monitor in monitors:
            # Get physical monitor count
            count = DWORD()
            if not windll.dxva2.GetNumberOfPhysicalMonitorsFromHMONITOR(monitor, byref(count)):
                raise WinError()
            if count.value&gt;0:
                # Get physical monitor handles
                physical_array = (VCP._PHYSICAL_MONITOR * count.value)()
                if not windll.dxva2.GetPhysicalMonitorsFromHMONITOR(monitor, count.value, physical_array):
                    raise WinError()
                for item in physical_array:
                    yield item.handle
                    windll.dxva2.DestroyPhysicalMonitor(item.handle)
    def filter_displays(display, *args):
        &#39;&#39;&#39;
        Searches through the information for all detected displays and attempts to return the info matching the value given.
        Will attempt to match against index, name, model and serial

        Args:
            display (str or int): what you are searching for. Can be serial number, name, model number or index of the display
            args (tuple): [*Optional*] if `args` isn&#39;t empty the function searches through args[0]. Otherwise it searches through the return of `VCP.get_display_info()`

        Raises:
            IndexError: if the display value is an int and an `IndexError` occurs when using it as a list index
            LookupError: if the display, as a str, does not have a match

        Returns:
            dict

        Example:
            ```python
            import screen_brightness_control as sbc

            search = &#39;BNQ78A7&#39;
            match = sbc.windows.VCP.filter_displays(search)
            print(match)
            # EG output: {&#39;name&#39;: &#39;BenQ BNQ78A7&#39;, &#39;model&#39;: &#39;BNQ78A7&#39;, ... }
            ```
        &#39;&#39;&#39;
        if len(args)==1:
            info = args[0]
        else:
            info = VCP.get_display_info()
        if type(display) is int:
            return info[display]
        else:
            for i in info:
                if display in (i[&#39;serial&#39;], i[&#39;model&#39;], i[&#39;name&#39;]):
                    return i
            raise LookupError(&#39;could not find matching display&#39;)
    def get_display_info(*args):
        &#39;&#39;&#39;
        Returns a dictionary of info about all detected monitors or a selection of monitors

        Args:
            args (tuple): [*Optional*] a variable list of monitors. Pass in a monitor&#39;s name/serial/model/index and only the information corresponding to these monitors will be returned

        Returns:
            list: list of dicts if `args` is empty or there are multiple values passed in `args`
            dict: if one value was passed through `args` and it matched a known monitor

        Example:
            ```python
            import screen_brightness_control as sbc

            # get the information about all monitors
            vcp_info = sbc.windows.VCP.get_display_info()
            print(vcp_info)
            # EG output: [{&#39;name&#39;: &#39;BenQ BNQ78A7&#39;, &#39;model&#39;: &#39;BNQ78A7&#39;, ... }, {&#39;name&#39;: &#39;Dell DEL405E&#39;, &#39;model&#39;: &#39;DEL405E&#39;, ... }]

            # get information about a monitor with this specific model
            bnq_info = sbc.windows.VCP.get_display_info(&#39;BNQ78A7&#39;)
            # EG output: {&#39;name&#39;: &#39;BenQ BNQ78A7&#39;, &#39;model&#39;: &#39;BNQ78A7&#39;, ... }

            # get information about 2 specific monitors at the same time
            sbc.windows.VCP.get_display_info(&#39;DEL405E&#39;, &#39;BNQ78A7&#39;)
            # EG output: [{&#39;name&#39;: &#39;Dell DEL405E&#39;, &#39;model&#39;: &#39;DEL405E&#39;, ... }, {&#39;name&#39;: &#39;BenQ BNQ78A7&#39;, &#39;model&#39;: &#39;BNQ78A7&#39;, ... }]
            ```
        &#39;&#39;&#39;
        info = []
        try:
            monitors_enum = win32api.EnumDisplayMonitors()
            monitors = [win32api.GetMonitorInfo(i[0]) for i in monitors_enum]
            monitors = [win32api.EnumDisplayDevices(i[&#39;Device&#39;], 0, 1).DeviceID for i in monitors]
            a=0
            for ms in monitors:
                m = ms.split(&#39;#&#39;)
                serial = m[2]
                model = m[1]

                man_id = model[:3]
                manufacturer = _monitor_brand_lookup(man_id)
                manufacturer = &#39;Unknown&#39; if manufacturer==None else manufacturer

                tmp = {&#39;name&#39;:f&#39;{manufacturer} {model}&#39;, &#39;model&#39;:model, &#39;model_name&#39;: None, &#39;serial&#39;:serial, &#39;manufacturer&#39;: manufacturer, &#39;manufacturer_id&#39;: man_id , &#39;index&#39;: a, &#39;method&#39;: VCP}
                info.append(tmp)
                a+=1
        except:
            pass
        if len(args)&gt;0:
            try:
                info = [VCP.filter_displays(i, info) for i in args]
                return info[0] if len(info)==1 else info
            except:
                pass
        return info
    def get_monitor_caps(monitor):
        &#39;&#39;&#39;
        Fetches and returns the VCP capabilities string of a monitor.
        This function takes anywhere from 1-2 seconds to run

        Args:
            monitor: a monitor handle as returned by `VCP.iter_physical_monitors()`

        Returns:
            str: a string of the monitor&#39;s capabilities

        Examples:
            ```python
            import screen_brightness_control as sbc

            for monitor in sbc.windows.VCP.iter_physical_monitors():
                print(sbc.windows.VCP.get_monitor_caps(monitor))
            # EG output: &#39;(prot(monitor)type(LCD)model(GL2450HM)cmds(01 02 03 07 0C F3)vcp(02 04 05 08 0B 0C 10 12 14(04 05 08 0B) 16 18 1A 52 60(01 03 11)62 8D(01 02)AC AE B2 B6 C0 C6 C8 C9 CA(01 02) CC(01 02 03 04 05 06 09 0A 0B 0D 0E 12 14 1A 1E 1F 20)D6(01 05) DF)mswhql(1)mccs_ver(2.1)asset_eep(32)mpu_ver(1.02))&#39;
            ```
        &#39;&#39;&#39;
        caps_string_length = DWORD()
        if not windll.dxva2.GetCapabilitiesStringLength(monitor,ctypes.byref(caps_string_length)):
            return
        caps_string = (ctypes.c_char * caps_string_length.value)()
        if not windll.dxva2.CapabilitiesRequestAndCapabilitiesReply(monitor, caps_string, caps_string_length):
            return
        return caps_string.value.decode(&#39;ASCII&#39;)
    def get_display_names(*args):
        &#39;&#39;&#39;
        Parse the VCP capabilities string of a monitor to get the actual model name of the monitor.
        So instead of this generic panel model (eg: BNQ78A7) it returns the user-friendly version (GL2450HM).
        This function takes a few seconds to run as it calls `VCP.get_monitor_caps()` for each monitor requested

        Args:
            args (tuple): [*Optional*] a variable list of monitors to get the names of, each item must be the monitor&#39;s handle as returned by `VCP.iter_physical_monitors()`

        Returns:
            list: list of strings

        Example:
            ```python
            import screen_brightness_control as sbc

            names = sbc.windows.VCP.get_display_names()
            print(names)
            # EG output: [&#39;GL2450HM&#39;, &#39;U2211H&#39;]

            # Get all the names if a monitor is not None
            names = []
            for monitor in sbc.windows.VCP.iter_physical_monitors():
                if monitor:
                    names.append(
                        sbc.windows.VCP.get_display_names(monitor)
                    )
            print(names)
            # EG output: [&#39;U2211H&#39;]
            ```
        &#39;&#39;&#39;
        names = []
        if len(args)&gt;0:
            monitors = lambda:args
        else:
            monitors = VCP.iter_physical_monitors

        for monitor in monitors():
            key = VCP.get_monitor_caps(monitor)
            cap = key[key.index(&#39;model(&#39;)+6:]
            cap = cap[:cap.index(&#39;)&#39;)]
            names.append(cap)
        return names
    def get_brightness(display=None):
        &#39;&#39;&#39;
        Retrieve the brightness of all connected displays using the `ctypes.windll` API

        Args:
            display (int or str): the specific display you wish to query. Is passed to `VCP.filter_displays` to match to a display

        Returns:
            list: list of ints from 0 to 100 if multiple displays are detected and the `display` kwarg is not set
            int: from 0 to 100 if there is only one display detected or the `display` kwarg is set

        Examples:
            ```python
            import screen_brightness_control as sbc

            # Get the brightness for all detected displays
            current_brightness = sbc.windows.VCP.get_brightness()
            if type(current_brightness) is int:
                print(&#39;There is only one detected display&#39;)
            else:
                print(&#39;There are&#39;, len(current_brightness), &#39;detected displays&#39;)

            # Get the brightness for the primary display
            primary_brightness = sbc.windows.VCP.get_brightness(display = 0)

            # Get the brightness for a secondary display
            secondary_brightness = sbc.windows.VCP.get_brightness(display = 1)

            # Get the brightness for a display with the model &#39;BNQ78A7&#39;
            benq_brightness = sbc.windows.VCP.get_brightness(display = &#39;BNQ78A7&#39;)
            ```
        &#39;&#39;&#39;
        values = []
        for m in VCP.iter_physical_monitors():
            cur_out = DWORD()
            if windll.dxva2.GetVCPFeatureAndVCPFeatureReply(HANDLE(m), BYTE(0x10), None, byref(cur_out), None):
                values.append(cur_out.value)
            del(cur_out)

        if display!=None:
            display = VCP.filter_displays(display)
            values = [values[display[&#39;index&#39;]]]

        return values[0] if len(values)==1 else values
    def set_brightness(value, display=None, no_return=False):
        &#39;&#39;&#39;
        Sets the brightness for all connected displays using the `ctypes.windll` API

        Args:
            display (int or str): the specific display you wish to query. Is passed to `VCP.filter_displays` to match to a display
            no_return (bool): if set to `True` this function will return `None`

        Returns:
            The result of `VCP.get_brightness()` (with the same `display` kwarg) if `no_return` is not set

        Examples:
            ```python
            import screen_brightness_control as sbc

            # Set the brightness for all detected displays to 50%
            sbc.windows.VCP.set_brightness(50)

            # Set the brightness for the primary display to 75%
            sbc.windows.VCP.set_brightness(75, display = 0)

            # Set the brightness for a secondary display to 25%
            sbc.windows.VCP.set_brightness(25, display = 1)

            # Set the brightness for a display with the model &#39;BNQ78A7&#39; to 100%
            sbc.windows.VCP.set_brightness(100, display = &#39;BNQ78A7&#39;)
            ```
        &#39;&#39;&#39;
        if display!=None:
            display = VCP.filter_displays(display)
            display = display[&#39;index&#39;]
        loops = 0
        for m in VCP.iter_physical_monitors():
            if display==None or (display == loops):
                windll.dxva2.SetVCPFeature(HANDLE(m), BYTE(0x10), DWORD(value))
            loops+=1
        return VCP.get_brightness(display=display) if not no_return else None

class Monitor(object):
    &#39;&#39;&#39;A class to manage a single monitor and its relevant information&#39;&#39;&#39;
    def __init__(self, display):
        &#39;&#39;&#39;
        Args:
            display (int or str): the index/model name/serial of the display you wish to control

        Raises:
            LookupError: if the given display is a string but that string does not match any known displays
            TypeError: if the given display type is not int or str

        Example:
            ```python
            import screen_brightness_control as sbc

            # create a class for the primary monitor and then a specificly named monitor
            primary = sbc.windows.Monitor(0)
            benq_monitor = sbc.windows.Monitor(&#39;BenQ BNQ78A7&#39;)

            # check if the benq monitor is the primary one
            if primary.serial == benq_monitor.serial:
                print(&#39;BNQ78A7 is the primary display&#39;)
            else:
                print(&#39;The primary display is&#39;, primary.name)

            # this class can also be accessed like a dictionary
            print(primary[&#39;name&#39;])
            print(benq_monitor[&#39;name&#39;])
            ```
        &#39;&#39;&#39;
        if type(display) is dict:
            info = display
        else:
            info = list_monitors_info()
            if type(display) is int:
                info = info[display]
            elif type(display) is str:
                for i in info:
                    if display in (i[&#39;serial&#39;], i[&#39;name&#39;], i[&#39;model&#39;]):
                        info = i
                if type(info) == list:#we haven&#39;t found a match
                    raise LookupError(&#39;could not match display info to known displays&#39;)
            else:
                raise TypeError(f&#39;display arg must be int or str, not {type(display)}&#39;)

        self.serial = info[&#39;serial&#39;]
        &#39;&#39;&#39;a unique string assigned by Windows to this monitor&#39;&#39;&#39;
        self.name = info[&#39;name&#39;]
        &#39;&#39;&#39;the monitors manufacturer name plus its model&#39;&#39;&#39;
        self.method = info[&#39;method&#39;]
        &#39;&#39;&#39;the method by which this monitor can be addressed. Will be either `WMI` or `VCP`&#39;&#39;&#39;
        self.manufacturer = info[&#39;manufacturer&#39;]
        &#39;&#39;&#39;the name of the brand of the monitor&#39;&#39;&#39;
        self.manufacturer_id = info[&#39;manufacturer_id&#39;]
        &#39;&#39;&#39;the 3 letter manufacturing code corresponding to the manufacturer name&#39;&#39;&#39;
        self.model = info[&#39;model&#39;]
        &#39;&#39;&#39;the general model of the display&#39;&#39;&#39;
        self.model_name = info[&#39;model_name&#39;]
        &#39;&#39;&#39;the model name of the display. Is always equal to `None` unless the method is `VCP`.
        If the method is `VCP` and you try to access this variable it will be loaded on-request (because it takes 1-2 seconds)&#39;&#39;&#39;
        self.index = info[&#39;index&#39;]
        &#39;&#39;&#39;the index of the monitor FOR THE SPECIFIC METHOD THIS MONITOR USES.
        This means that if the monitor uses `WMI`, the index is out of the list of `WMI` addressable monitors ONLY. Same for `VCP`&#39;&#39;&#39;
    def __getitem__(self, item):
        return getattr(self, item)
    def __getattribute__(self, attr):
        if attr == &#39;model_name&#39; and object.__getattribute__(self, &#39;model_name&#39;)==None:
            model_name = object.__getattribute__(self, &#39;method&#39;).get_display_names()[object.__getattribute__(self, &#39;index&#39;)]
            setattr(self, &#39;model_name&#39;, model_name)
            return model_name
        else:
            return object.__getattribute__(self, attr)
    def set_brightness(self, *args, **kwargs):
        &#39;&#39;&#39;
        Sets the brightness for this display

        Args:
            args (tuple): passed directly to this monitor&#39;s brightness method
            kwargs (dict): passed directly to this monitor&#39;s brightness method (the `display` kwarg is always overwritten)

        Returns:
            int: from 0 to 100

        Example:
            ```python
            import screen_brightness_control as sbc

            # set the brightness of the primary monitor to 50%
            primary = sbc.windows.Monitor(0)
            primary_brightness = primary.set_brightness(50)
            ```
        &#39;&#39;&#39;
        kwargs[&#39;display&#39;] = self.serial
        return self.method.set_brightness(*args, **kwargs)
    def get_brightness(self, **kwargs):
        &#39;&#39;&#39;
        Returns the brightness of this display

        Args:
            kwargs (dict): passed directly to this monitor&#39;s brightness method (`display` kwarg is always overwritten)

        Returns:
            int: from 0 to 100

        Example:
            ```python
            import screen_brightness_control as sbc

            # get the brightness of the primary monitor
            primary = sbc.windows.Monitor(0)
            primary_brightness = primary.get_brightness()
            ```
        &#39;&#39;&#39;
        kwargs[&#39;display&#39;] = self.serial
        return self.method.get_brightness(**kwargs)
    def get_info(self):
        &#39;&#39;&#39;
        Returns all known information about this monitor instance.
        If the monitor&#39;s method is `VCP` it also loads the `Monitor.model_name` attribute

        Returns:
            dict

        Example:
            ```python
            import screen_brightness_control as sbc

            # initialize class for primary monitor
            primary = sbc.windows.Monitor(0)
            # get the info
            info = primary.get_info()
            ```
        &#39;&#39;&#39;
        try:
            if self.model_name == None:
                info = self.method.get_display_info()
                for i in range(len(info)):
                    if info[i][&#39;serial&#39;]==self.serial:
                        self.model_name = info[i]
        except:
            pass
        return {
            &#39;name&#39;:self.name,
            &#39;model&#39;:self.model,
            &#39;model_name&#39;: self.model_name,
            &#39;serial&#39;:self.serial,
            &#39;manufacturer&#39;: self.manufacturer,
            &#39;manufacturer_id&#39;: self.manufacturer_id,
            &#39;method&#39;: self.method,
            &#39;index&#39;: self.index
        }
    def is_active(self):
        &#39;&#39;&#39;
        Attempts to retrieve the brightness for this display. If it works the display is deemed active

        Returns:
            bool: True means active, False means inactive

        Example:
            ```python
            import screen_brightness_control as sbc

            primary = sbc.windows.Monitor(0)
            if primary.is_active():
                primary.set_brightness(50)
            ```
        &#39;&#39;&#39;
        try:
            self.get_brightness()
            return True
        except:
            return False

def list_monitors_info(method=None):
    &#39;&#39;&#39;
    Lists detailed information about all detected monitors

    Args:
        method (str): the method the monitor can be addressed by. Can be &#39;wmi&#39; or &#39;vcp&#39;

    Returns:
        list: list of dictionaries upon success, empty list upon failure

    Example:
        ```python
        import screen_brightness_control as sbc

        monitors = sbc.windows.list_monitors_info()
        for info in monitors:
            print(&#39;=======================&#39;)
            print(&#39;Name:&#39;, info[&#39;name&#39;]) # the manufacturer name plus the model
            print(&#39;Model:&#39;, info[&#39;model&#39;]) # the general model of the display
            print(&#39;Serial:&#39;, info[&#39;serial&#39;]) # a unique string assigned by Windows to this display
            print(&#39;Manufacturer:&#39;, info[&#39;manufacturer&#39;]) # the name of the brand of the monitor
            print(&#39;Manufacturer ID:&#39;, info[&#39;manufacturer_id&#39;]) # the 3 letter code corresponding to the brand name, EG: BNQ -&gt; BenQ
            print(&#39;Index:&#39;, info[&#39;index&#39;]) # the index of that display FOR THE SPECIFIC METHOD THE DISPLAY USES
            print(&#39;Method:&#39;, info[&#39;method&#39;]) # the method this monitor can be addressed by
        ```
    &#39;&#39;&#39;
    tmp = []
    methods = [WMI,VCP]
    if method!=None:
        if method.lower()==&#39;wmi&#39;:methods=[WMI]
        elif method.lower()==&#39;vcp&#39;:methods=[VCP]
        else:raise ValueError(&#39;method kwarg must be \&#39;wmi\&#39; or \&#39;vcp\&#39;&#39;)
    for m in methods:
        tmp.append(m.get_display_info())
    tmp = flatten_list(tmp)
    info = []
    serials = []
    #to make sure each display (with unique serial) is only reported once
    for i in tmp:
        if i[&#39;serial&#39;] not in serials:
            serials.append(i[&#39;serial&#39;])
            info.append(i)
    return flatten_list(info)

def list_monitors(method=None):
    &#39;&#39;&#39;
    Returns a list of all addressable monitor names

    Args:
        method (str): the method the monitor can be addressed by. Can be &#39;wmi&#39; or &#39;vcp&#39;

    Returns:
        list: list of strings

    Example:
        ```python
        import screen_brightness_control as sbc

        monitors = sbc.windows.list_monitors()
        # EG output: [&#39;BenQ BNQ78A7&#39;, &#39;Dell DEL405E&#39;]
        ```
    &#39;&#39;&#39;
    displays = [i[&#39;name&#39;] for i in list_monitors_info(method=method)]
    return flatten_list(displays)

def __filter_monitors(display=None, method=None):
    &#39;&#39;&#39;internal function, do not call
    filters the list of all addressable monitors by:
        whether their name/model/serial/model_name matches the display kwarg
        whether they use the method matching the method kwarg&#39;&#39;&#39;
    methods = [WMI, VCP]
    #parse the method kwarg
    monitors = list_monitors_info(method = method)
    if method!=None and monitors==[]:
        raise LookupError(&#39;no monitors detected with matching method&#39;)

    #parse display kwarg by trying to match given term to known monitors
    if display!=None:
        if type(display) is int:
            monitors = [monitors[display]]
        elif type(display) is str:
            #see if display matches serial names, models or given names for monitors
            m = [i for i in monitors if display in (i[&#39;serial&#39;], i[&#39;name&#39;], i[&#39;model&#39;])]
            #if no matches found, try to match model_name (takes longer)
            if m == []:
                names = [i.get_display_names() for i in methods]
                names = flatten_list(names)
                if display in names:
                    display = names.index(display)
                    m = [monitors[display]]
            monitors = m
        else:
            raise TypeError(f&#39;display must be int or str, not {type(display)}&#39;)
    if monitors == []:
        msg = &#39;no monitors found&#39;
        if display!=None:
            msg+=f&#39; with name/serial/model of &#34;{display}&#34;&#39;
        if method!=None:
            msg+=f&#39; with method of &#34;{method}&#34;&#39;
        raise LookupError(msg)
    return monitors

def __set_and_get_brightness(*args, display=None, method=None, meta_method=&#39;get&#39;, **kwargs):
    &#39;&#39;&#39;internal function, do not call.
    either sets the brightness or gets it. Exists because set_brightness and get_brightness only have a couple differences&#39;&#39;&#39;
    errors = []
    try: # filter known list of monitors according to kwargs
        monitors = __filter_monitors(display = display, method = method)
    except Exception as e:
        errors.append([&#39;&#39;,type(e).__name__, e])
    else:
        output = []
        for m in monitors: # add the output of each brightness method to the output list
            try:
                output.append(
                    getattr(m[&#39;method&#39;], meta_method+&#39;_brightness&#39;)(*args, display = m[&#39;serial&#39;], **kwargs)
                )
            except Exception as e:
                output.append(None)
                errors.append([f&#34;{m[&#39;name&#39;]} ({m[&#39;serial&#39;]})&#34;, type(e).__name__, e])

        if output!=[] and not all(i==None for i in output): # flatten and return any output
            output = flatten_list(output)
            return output[0] if len(output)==1 else output

    #if function hasn&#39;t already returned it has failed
    msg=&#39;\n&#39;
    for e in errors:
        msg+=f&#39;\t{e[0]} -&gt; {e[1]}: {e[2]}\n&#39;
    if msg==&#39;\n&#39;:
        msg+=&#39;\tno valid output was received from brightness methods&#39;
    raise Exception(msg)

def set_brightness(value, display=None, method = None, **kwargs):
    &#39;&#39;&#39;
    Sets the brightness of any connected monitors

    Args:
        value (int): Sets the brightness to this value as a percentage
        display (int or str): the specific display you wish to adjust. can be index, model, name or serial of the display
        method (str): the method to use (&#39;wmi&#39; or &#39;vcp&#39;)
        kwargs (dict): passed directly to the chosen brightness method

    Returns:
        Whatever the called methods return (See `WMI.set_brightness` and `VCP.set_brightness` for details).
        Typically it will list, int (0 to 100) or None

    Raises:
        LookupError: if the chosen display (with method if applicable) is not found
        ValueError: if the chosen method is invalid
        TypeError: if the value given for `display` is not int or str
        Exception: if the brightness could not be set by any method

    Example:
        ```python
        import screen_brightness_control as sbc

        # set the current brightness to 50%
        sbc.windows.set_brightness(50)

        # set the brightness of the primary display to 75%
        sbc.windows.set_brightness(75, display = 0)

        # set the brightness of any displays using VCP to 25%
        sbc.windows.set_brightness(25, method = &#39;vcp&#39;)

        # set the brightness of displays with the model name &#39;BenQ BNQ78A7&#39; (see `list_monitors` and `list_monitors_info`) to 100%
        sbc.windows.set_brightness(100, display = &#39;BenQ BNQ78A7&#39;)
        ```
    &#39;&#39;&#39;
    # this function is called because set_brightness and get_brightness only differed by 1 line of code
    # so I made another internal function to reduce the filesize
    return __set_and_get_brightness(value, display=display, method=method, meta_method=&#39;set&#39;, **kwargs)

def get_brightness(display = None, method = None, **kwargs):
    &#39;&#39;&#39;
    Returns the brightness of any connected monitors

    Args:
        display (int or str): the specific display you wish to adjust. can be index, model, name or serial of the display
        method (str): the method to use (&#39;wmi&#39; or &#39;vcp&#39;)
        kwargs (dict): passed directly to chosen brightness method

    Returns:
        int: from 0 to 100 if only one display is detected or the `display` kwarg is set
        list: list of integers if multiple displays are detected and the `display` kwarg isn&#39;t set (invalid monitors return `None`)

    Raises:
        LookupError: if the chosen display (with method if applicable) is not found
        ValueError: if the chosen method is invalid
        TypeError: if the value given for `display` is not int or str
        Exception: if the brightness could not be obtained by any method

    Example:
        ```python
        import screen_brightness_control as sbc

        # get the current brightness
        current_brightness = sbc.windows.get_brightness()
        if type(current_brightness) is int:
            print(&#39;There is only one detected display&#39;)
        else:
            print(&#39;There are&#39;, len(current_brightness), &#39;detected displays&#39;)

        # get the brightness of the primary display
        primary_brightness = sbc.windows.get_brightness(display = 0)

        # get the brightness of any displays using VCP
        vcp_brightness = sbc.windows.get_brightness(method = &#39;vcp&#39;)

        # get the brightness of displays with the model name &#39;BenQ BNQ78A7&#39;
        benq_brightness = sbc.windows.get_brightness(display = &#39;BenQ BNQ78A7&#39;)
        ```
    &#39;&#39;&#39;
    # this function is called because set_brightness and get_brightness only differed by 1 line of code
    # so I made another internal function to reduce the filesize
    return __set_and_get_brightness(display=display, method=method, meta_method=&#39;get&#39;, **kwargs)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="screen_brightness_control.windows.get_brightness"><code class="name flex">
<span>def <span class="ident">get_brightness</span></span>(<span>display=None, method=None, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the brightness of any connected monitors</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>display</code></strong> :&ensp;<code>int</code> or <code>str</code></dt>
<dd>the specific display you wish to adjust. can be index, model, name or serial of the display</dd>
<dt><strong><code>method</code></strong> :&ensp;<code>str</code></dt>
<dd>the method to use ('wmi' or 'vcp')</dd>
<dt><strong><code>kwargs</code></strong> :&ensp;<code>dict</code></dt>
<dd>passed directly to chosen brightness method</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>int</code></dt>
<dd>from 0 to 100 if only one display is detected or the <code>display</code> kwarg is set</dd>
<dt><code>list</code></dt>
<dd>list of integers if multiple displays are detected and the <code>display</code> kwarg isn't set (invalid monitors return <code>None</code>)</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>LookupError</code></dt>
<dd>if the chosen display (with method if applicable) is not found</dd>
<dt><code>ValueError</code></dt>
<dd>if the chosen method is invalid</dd>
<dt><code>TypeError</code></dt>
<dd>if the value given for <code>display</code> is not int or str</dd>
<dt><code>Exception</code></dt>
<dd>if the brightness could not be obtained by any method</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

# get the current brightness
current_brightness = sbc.windows.get_brightness()
if type(current_brightness) is int:
    print('There is only one detected display')
else:
    print('There are', len(current_brightness), 'detected displays')

# get the brightness of the primary display
primary_brightness = sbc.windows.get_brightness(display = 0)

# get the brightness of any displays using VCP
vcp_brightness = sbc.windows.get_brightness(method = 'vcp')

# get the brightness of displays with the model name 'BenQ BNQ78A7'
benq_brightness = sbc.windows.get_brightness(display = 'BenQ BNQ78A7')
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_brightness(display = None, method = None, **kwargs):
    &#39;&#39;&#39;
    Returns the brightness of any connected monitors

    Args:
        display (int or str): the specific display you wish to adjust. can be index, model, name or serial of the display
        method (str): the method to use (&#39;wmi&#39; or &#39;vcp&#39;)
        kwargs (dict): passed directly to chosen brightness method

    Returns:
        int: from 0 to 100 if only one display is detected or the `display` kwarg is set
        list: list of integers if multiple displays are detected and the `display` kwarg isn&#39;t set (invalid monitors return `None`)

    Raises:
        LookupError: if the chosen display (with method if applicable) is not found
        ValueError: if the chosen method is invalid
        TypeError: if the value given for `display` is not int or str
        Exception: if the brightness could not be obtained by any method

    Example:
        ```python
        import screen_brightness_control as sbc

        # get the current brightness
        current_brightness = sbc.windows.get_brightness()
        if type(current_brightness) is int:
            print(&#39;There is only one detected display&#39;)
        else:
            print(&#39;There are&#39;, len(current_brightness), &#39;detected displays&#39;)

        # get the brightness of the primary display
        primary_brightness = sbc.windows.get_brightness(display = 0)

        # get the brightness of any displays using VCP
        vcp_brightness = sbc.windows.get_brightness(method = &#39;vcp&#39;)

        # get the brightness of displays with the model name &#39;BenQ BNQ78A7&#39;
        benq_brightness = sbc.windows.get_brightness(display = &#39;BenQ BNQ78A7&#39;)
        ```
    &#39;&#39;&#39;
    # this function is called because set_brightness and get_brightness only differed by 1 line of code
    # so I made another internal function to reduce the filesize
    return __set_and_get_brightness(display=display, method=method, meta_method=&#39;get&#39;, **kwargs)</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.list_monitors"><code class="name flex">
<span>def <span class="ident">list_monitors</span></span>(<span>method=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns a list of all addressable monitor names</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>method</code></strong> :&ensp;<code>str</code></dt>
<dd>the method the monitor can be addressed by. Can be 'wmi' or 'vcp'</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>list of strings</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

monitors = sbc.windows.list_monitors()
# EG output: ['BenQ BNQ78A7', 'Dell DEL405E']
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def list_monitors(method=None):
    &#39;&#39;&#39;
    Returns a list of all addressable monitor names

    Args:
        method (str): the method the monitor can be addressed by. Can be &#39;wmi&#39; or &#39;vcp&#39;

    Returns:
        list: list of strings

    Example:
        ```python
        import screen_brightness_control as sbc

        monitors = sbc.windows.list_monitors()
        # EG output: [&#39;BenQ BNQ78A7&#39;, &#39;Dell DEL405E&#39;]
        ```
    &#39;&#39;&#39;
    displays = [i[&#39;name&#39;] for i in list_monitors_info(method=method)]
    return flatten_list(displays)</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.list_monitors_info"><code class="name flex">
<span>def <span class="ident">list_monitors_info</span></span>(<span>method=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Lists detailed information about all detected monitors</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>method</code></strong> :&ensp;<code>str</code></dt>
<dd>the method the monitor can be addressed by. Can be 'wmi' or 'vcp'</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>list of dictionaries upon success, empty list upon failure</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

monitors = sbc.windows.list_monitors_info()
for info in monitors:
    print('=======================')
    print('Name:', info['name']) # the manufacturer name plus the model
    print('Model:', info['model']) # the general model of the display
    print('Serial:', info['serial']) # a unique string assigned by Windows to this display
    print('Manufacturer:', info['manufacturer']) # the name of the brand of the monitor
    print('Manufacturer ID:', info['manufacturer_id']) # the 3 letter code corresponding to the brand name, EG: BNQ -&gt; BenQ
    print('Index:', info['index']) # the index of that display FOR THE SPECIFIC METHOD THE DISPLAY USES
    print('Method:', info['method']) # the method this monitor can be addressed by
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def list_monitors_info(method=None):
    &#39;&#39;&#39;
    Lists detailed information about all detected monitors

    Args:
        method (str): the method the monitor can be addressed by. Can be &#39;wmi&#39; or &#39;vcp&#39;

    Returns:
        list: list of dictionaries upon success, empty list upon failure

    Example:
        ```python
        import screen_brightness_control as sbc

        monitors = sbc.windows.list_monitors_info()
        for info in monitors:
            print(&#39;=======================&#39;)
            print(&#39;Name:&#39;, info[&#39;name&#39;]) # the manufacturer name plus the model
            print(&#39;Model:&#39;, info[&#39;model&#39;]) # the general model of the display
            print(&#39;Serial:&#39;, info[&#39;serial&#39;]) # a unique string assigned by Windows to this display
            print(&#39;Manufacturer:&#39;, info[&#39;manufacturer&#39;]) # the name of the brand of the monitor
            print(&#39;Manufacturer ID:&#39;, info[&#39;manufacturer_id&#39;]) # the 3 letter code corresponding to the brand name, EG: BNQ -&gt; BenQ
            print(&#39;Index:&#39;, info[&#39;index&#39;]) # the index of that display FOR THE SPECIFIC METHOD THE DISPLAY USES
            print(&#39;Method:&#39;, info[&#39;method&#39;]) # the method this monitor can be addressed by
        ```
    &#39;&#39;&#39;
    tmp = []
    methods = [WMI,VCP]
    if method!=None:
        if method.lower()==&#39;wmi&#39;:methods=[WMI]
        elif method.lower()==&#39;vcp&#39;:methods=[VCP]
        else:raise ValueError(&#39;method kwarg must be \&#39;wmi\&#39; or \&#39;vcp\&#39;&#39;)
    for m in methods:
        tmp.append(m.get_display_info())
    tmp = flatten_list(tmp)
    info = []
    serials = []
    #to make sure each display (with unique serial) is only reported once
    for i in tmp:
        if i[&#39;serial&#39;] not in serials:
            serials.append(i[&#39;serial&#39;])
            info.append(i)
    return flatten_list(info)</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.set_brightness"><code class="name flex">
<span>def <span class="ident">set_brightness</span></span>(<span>value, display=None, method=None, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Sets the brightness of any connected monitors</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>value</code></strong> :&ensp;<code>int</code></dt>
<dd>Sets the brightness to this value as a percentage</dd>
<dt><strong><code>display</code></strong> :&ensp;<code>int</code> or <code>str</code></dt>
<dd>the specific display you wish to adjust. can be index, model, name or serial of the display</dd>
<dt><strong><code>method</code></strong> :&ensp;<code>str</code></dt>
<dd>the method to use ('wmi' or 'vcp')</dd>
<dt><strong><code>kwargs</code></strong> :&ensp;<code>dict</code></dt>
<dd>passed directly to the chosen brightness method</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>Whatever the called methods return (See <code><a title="screen_brightness_control.windows.WMI.set_brightness" href="#screen_brightness_control.windows.WMI.set_brightness">WMI.set_brightness()</a></code> and <code><a title="screen_brightness_control.windows.VCP.set_brightness" href="#screen_brightness_control.windows.VCP.set_brightness">VCP.set_brightness()</a></code> for details).
Typically it will list, int (0 to 100) or None</p>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>LookupError</code></dt>
<dd>if the chosen display (with method if applicable) is not found</dd>
<dt><code>ValueError</code></dt>
<dd>if the chosen method is invalid</dd>
<dt><code>TypeError</code></dt>
<dd>if the value given for <code>display</code> is not int or str</dd>
<dt><code>Exception</code></dt>
<dd>if the brightness could not be set by any method</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

# set the current brightness to 50%
sbc.windows.set_brightness(50)

# set the brightness of the primary display to 75%
sbc.windows.set_brightness(75, display = 0)

# set the brightness of any displays using VCP to 25%
sbc.windows.set_brightness(25, method = 'vcp')

# set the brightness of displays with the model name 'BenQ BNQ78A7' (see &lt;code&gt;&lt;a title=&quot;screen_brightness_control.windows.list_monitors&quot; href=&quot;#screen_brightness_control.windows.list_monitors&quot;&gt;list\_monitors()&lt;/a&gt;&lt;/code&gt; and &lt;code&gt;&lt;a title=&quot;screen_brightness_control.windows.list_monitors_info&quot; href=&quot;#screen_brightness_control.windows.list_monitors_info&quot;&gt;list\_monitors\_info()&lt;/a&gt;&lt;/code&gt;) to 100%
sbc.windows.set_brightness(100, display = 'BenQ BNQ78A7')
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_brightness(value, display=None, method = None, **kwargs):
    &#39;&#39;&#39;
    Sets the brightness of any connected monitors

    Args:
        value (int): Sets the brightness to this value as a percentage
        display (int or str): the specific display you wish to adjust. can be index, model, name or serial of the display
        method (str): the method to use (&#39;wmi&#39; or &#39;vcp&#39;)
        kwargs (dict): passed directly to the chosen brightness method

    Returns:
        Whatever the called methods return (See `WMI.set_brightness` and `VCP.set_brightness` for details).
        Typically it will list, int (0 to 100) or None

    Raises:
        LookupError: if the chosen display (with method if applicable) is not found
        ValueError: if the chosen method is invalid
        TypeError: if the value given for `display` is not int or str
        Exception: if the brightness could not be set by any method

    Example:
        ```python
        import screen_brightness_control as sbc

        # set the current brightness to 50%
        sbc.windows.set_brightness(50)

        # set the brightness of the primary display to 75%
        sbc.windows.set_brightness(75, display = 0)

        # set the brightness of any displays using VCP to 25%
        sbc.windows.set_brightness(25, method = &#39;vcp&#39;)

        # set the brightness of displays with the model name &#39;BenQ BNQ78A7&#39; (see `list_monitors` and `list_monitors_info`) to 100%
        sbc.windows.set_brightness(100, display = &#39;BenQ BNQ78A7&#39;)
        ```
    &#39;&#39;&#39;
    # this function is called because set_brightness and get_brightness only differed by 1 line of code
    # so I made another internal function to reduce the filesize
    return __set_and_get_brightness(value, display=display, method=method, meta_method=&#39;set&#39;, **kwargs)</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="screen_brightness_control.windows.Monitor"><code class="flex name class">
<span>class <span class="ident">Monitor</span></span>
<span>(</span><span>display)</span>
</code></dt>
<dd>
<div class="desc"><p>A class to manage a single monitor and its relevant information</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>display</code></strong> :&ensp;<code>int</code> or <code>str</code></dt>
<dd>the index/model name/serial of the display you wish to control</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>LookupError</code></dt>
<dd>if the given display is a string but that string does not match any known displays</dd>
<dt><code>TypeError</code></dt>
<dd>if the given display type is not int or str</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

# create a class for the primary monitor and then a specificly named monitor
primary = sbc.windows.Monitor(0)
benq_monitor = sbc.windows.Monitor('BenQ BNQ78A7')

# check if the benq monitor is the primary one
if primary.serial == benq_monitor.serial:
    print('BNQ78A7 is the primary display')
else:
    print('The primary display is', primary.name)

# this class can also be accessed like a dictionary
print(primary['name'])
print(benq_monitor['name'])
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Monitor(object):
    &#39;&#39;&#39;A class to manage a single monitor and its relevant information&#39;&#39;&#39;
    def __init__(self, display):
        &#39;&#39;&#39;
        Args:
            display (int or str): the index/model name/serial of the display you wish to control

        Raises:
            LookupError: if the given display is a string but that string does not match any known displays
            TypeError: if the given display type is not int or str

        Example:
            ```python
            import screen_brightness_control as sbc

            # create a class for the primary monitor and then a specificly named monitor
            primary = sbc.windows.Monitor(0)
            benq_monitor = sbc.windows.Monitor(&#39;BenQ BNQ78A7&#39;)

            # check if the benq monitor is the primary one
            if primary.serial == benq_monitor.serial:
                print(&#39;BNQ78A7 is the primary display&#39;)
            else:
                print(&#39;The primary display is&#39;, primary.name)

            # this class can also be accessed like a dictionary
            print(primary[&#39;name&#39;])
            print(benq_monitor[&#39;name&#39;])
            ```
        &#39;&#39;&#39;
        if type(display) is dict:
            info = display
        else:
            info = list_monitors_info()
            if type(display) is int:
                info = info[display]
            elif type(display) is str:
                for i in info:
                    if display in (i[&#39;serial&#39;], i[&#39;name&#39;], i[&#39;model&#39;]):
                        info = i
                if type(info) == list:#we haven&#39;t found a match
                    raise LookupError(&#39;could not match display info to known displays&#39;)
            else:
                raise TypeError(f&#39;display arg must be int or str, not {type(display)}&#39;)

        self.serial = info[&#39;serial&#39;]
        &#39;&#39;&#39;a unique string assigned by Windows to this monitor&#39;&#39;&#39;
        self.name = info[&#39;name&#39;]
        &#39;&#39;&#39;the monitors manufacturer name plus its model&#39;&#39;&#39;
        self.method = info[&#39;method&#39;]
        &#39;&#39;&#39;the method by which this monitor can be addressed. Will be either `WMI` or `VCP`&#39;&#39;&#39;
        self.manufacturer = info[&#39;manufacturer&#39;]
        &#39;&#39;&#39;the name of the brand of the monitor&#39;&#39;&#39;
        self.manufacturer_id = info[&#39;manufacturer_id&#39;]
        &#39;&#39;&#39;the 3 letter manufacturing code corresponding to the manufacturer name&#39;&#39;&#39;
        self.model = info[&#39;model&#39;]
        &#39;&#39;&#39;the general model of the display&#39;&#39;&#39;
        self.model_name = info[&#39;model_name&#39;]
        &#39;&#39;&#39;the model name of the display. Is always equal to `None` unless the method is `VCP`.
        If the method is `VCP` and you try to access this variable it will be loaded on-request (because it takes 1-2 seconds)&#39;&#39;&#39;
        self.index = info[&#39;index&#39;]
        &#39;&#39;&#39;the index of the monitor FOR THE SPECIFIC METHOD THIS MONITOR USES.
        This means that if the monitor uses `WMI`, the index is out of the list of `WMI` addressable monitors ONLY. Same for `VCP`&#39;&#39;&#39;
    def __getitem__(self, item):
        return getattr(self, item)
    def __getattribute__(self, attr):
        if attr == &#39;model_name&#39; and object.__getattribute__(self, &#39;model_name&#39;)==None:
            model_name = object.__getattribute__(self, &#39;method&#39;).get_display_names()[object.__getattribute__(self, &#39;index&#39;)]
            setattr(self, &#39;model_name&#39;, model_name)
            return model_name
        else:
            return object.__getattribute__(self, attr)
    def set_brightness(self, *args, **kwargs):
        &#39;&#39;&#39;
        Sets the brightness for this display

        Args:
            args (tuple): passed directly to this monitor&#39;s brightness method
            kwargs (dict): passed directly to this monitor&#39;s brightness method (the `display` kwarg is always overwritten)

        Returns:
            int: from 0 to 100

        Example:
            ```python
            import screen_brightness_control as sbc

            # set the brightness of the primary monitor to 50%
            primary = sbc.windows.Monitor(0)
            primary_brightness = primary.set_brightness(50)
            ```
        &#39;&#39;&#39;
        kwargs[&#39;display&#39;] = self.serial
        return self.method.set_brightness(*args, **kwargs)
    def get_brightness(self, **kwargs):
        &#39;&#39;&#39;
        Returns the brightness of this display

        Args:
            kwargs (dict): passed directly to this monitor&#39;s brightness method (`display` kwarg is always overwritten)

        Returns:
            int: from 0 to 100

        Example:
            ```python
            import screen_brightness_control as sbc

            # get the brightness of the primary monitor
            primary = sbc.windows.Monitor(0)
            primary_brightness = primary.get_brightness()
            ```
        &#39;&#39;&#39;
        kwargs[&#39;display&#39;] = self.serial
        return self.method.get_brightness(**kwargs)
    def get_info(self):
        &#39;&#39;&#39;
        Returns all known information about this monitor instance.
        If the monitor&#39;s method is `VCP` it also loads the `Monitor.model_name` attribute

        Returns:
            dict

        Example:
            ```python
            import screen_brightness_control as sbc

            # initialize class for primary monitor
            primary = sbc.windows.Monitor(0)
            # get the info
            info = primary.get_info()
            ```
        &#39;&#39;&#39;
        try:
            if self.model_name == None:
                info = self.method.get_display_info()
                for i in range(len(info)):
                    if info[i][&#39;serial&#39;]==self.serial:
                        self.model_name = info[i]
        except:
            pass
        return {
            &#39;name&#39;:self.name,
            &#39;model&#39;:self.model,
            &#39;model_name&#39;: self.model_name,
            &#39;serial&#39;:self.serial,
            &#39;manufacturer&#39;: self.manufacturer,
            &#39;manufacturer_id&#39;: self.manufacturer_id,
            &#39;method&#39;: self.method,
            &#39;index&#39;: self.index
        }
    def is_active(self):
        &#39;&#39;&#39;
        Attempts to retrieve the brightness for this display. If it works the display is deemed active

        Returns:
            bool: True means active, False means inactive

        Example:
            ```python
            import screen_brightness_control as sbc

            primary = sbc.windows.Monitor(0)
            if primary.is_active():
                primary.set_brightness(50)
            ```
        &#39;&#39;&#39;
        try:
            self.get_brightness()
            return True
        except:
            return False</code></pre>
</details>
<h3>Instance variables</h3>
<dl>
<dt id="screen_brightness_control.windows.Monitor.index"><code class="name">var <span class="ident">index</span></code></dt>
<dd>
<div class="desc"><p>the index of the monitor FOR THE SPECIFIC METHOD THIS MONITOR USES.
This means that if the monitor uses <code><a title="screen_brightness_control.windows.WMI" href="#screen_brightness_control.windows.WMI">WMI</a></code>, the index is out of the list of <code><a title="screen_brightness_control.windows.WMI" href="#screen_brightness_control.windows.WMI">WMI</a></code> addressable monitors ONLY. Same for <code><a title="screen_brightness_control.windows.VCP" href="#screen_brightness_control.windows.VCP">VCP</a></code></p></div>
</dd>
<dt id="screen_brightness_control.windows.Monitor.manufacturer"><code class="name">var <span class="ident">manufacturer</span></code></dt>
<dd>
<div class="desc"><p>the name of the brand of the monitor</p></div>
</dd>
<dt id="screen_brightness_control.windows.Monitor.manufacturer_id"><code class="name">var <span class="ident">manufacturer_id</span></code></dt>
<dd>
<div class="desc"><p>the 3 letter manufacturing code corresponding to the manufacturer name</p></div>
</dd>
<dt id="screen_brightness_control.windows.Monitor.method"><code class="name">var <span class="ident">method</span></code></dt>
<dd>
<div class="desc"><p>the method by which this monitor can be addressed. Will be either <code><a title="screen_brightness_control.windows.WMI" href="#screen_brightness_control.windows.WMI">WMI</a></code> or <code><a title="screen_brightness_control.windows.VCP" href="#screen_brightness_control.windows.VCP">VCP</a></code></p></div>
</dd>
<dt id="screen_brightness_control.windows.Monitor.model"><code class="name">var <span class="ident">model</span></code></dt>
<dd>
<div class="desc"><p>the general model of the display</p></div>
</dd>
<dt id="screen_brightness_control.windows.Monitor.model_name"><code class="name">var <span class="ident">model_name</span></code></dt>
<dd>
<div class="desc"><p>the model name of the display. Is always equal to <code>None</code> unless the method is <code><a title="screen_brightness_control.windows.VCP" href="#screen_brightness_control.windows.VCP">VCP</a></code>.
If the method is <code><a title="screen_brightness_control.windows.VCP" href="#screen_brightness_control.windows.VCP">VCP</a></code> and you try to access this variable it will be loaded on-request (because it takes 1-2 seconds)</p></div>
</dd>
<dt id="screen_brightness_control.windows.Monitor.name"><code class="name">var <span class="ident">name</span></code></dt>
<dd>
<div class="desc"><p>the monitors manufacturer name plus its model</p></div>
</dd>
<dt id="screen_brightness_control.windows.Monitor.serial"><code class="name">var <span class="ident">serial</span></code></dt>
<dd>
<div class="desc"><p>a unique string assigned by Windows to this monitor</p></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="screen_brightness_control.windows.Monitor.get_brightness"><code class="name flex">
<span>def <span class="ident">get_brightness</span></span>(<span>self, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the brightness of this display</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>kwargs</code></strong> :&ensp;<code>dict</code></dt>
<dd>passed directly to this monitor's brightness method (<code>display</code> kwarg is always overwritten)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>int</code></dt>
<dd>from 0 to 100</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

# get the brightness of the primary monitor
primary = sbc.windows.Monitor(0)
primary_brightness = primary.get_brightness()
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_brightness(self, **kwargs):
    &#39;&#39;&#39;
    Returns the brightness of this display

    Args:
        kwargs (dict): passed directly to this monitor&#39;s brightness method (`display` kwarg is always overwritten)

    Returns:
        int: from 0 to 100

    Example:
        ```python
        import screen_brightness_control as sbc

        # get the brightness of the primary monitor
        primary = sbc.windows.Monitor(0)
        primary_brightness = primary.get_brightness()
        ```
    &#39;&#39;&#39;
    kwargs[&#39;display&#39;] = self.serial
    return self.method.get_brightness(**kwargs)</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.Monitor.get_info"><code class="name flex">
<span>def <span class="ident">get_info</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns all known information about this monitor instance.
If the monitor's method is <code><a title="screen_brightness_control.windows.VCP" href="#screen_brightness_control.windows.VCP">VCP</a></code> it also loads the <code><a title="screen_brightness_control.windows.Monitor.model_name" href="#screen_brightness_control.windows.Monitor.model_name">Monitor.model_name</a></code> attribute</p>
<h2 id="returns">Returns</h2>
<p>dict</p>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

# initialize class for primary monitor
primary = sbc.windows.Monitor(0)
# get the info
info = primary.get_info()
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_info(self):
    &#39;&#39;&#39;
    Returns all known information about this monitor instance.
    If the monitor&#39;s method is `VCP` it also loads the `Monitor.model_name` attribute

    Returns:
        dict

    Example:
        ```python
        import screen_brightness_control as sbc

        # initialize class for primary monitor
        primary = sbc.windows.Monitor(0)
        # get the info
        info = primary.get_info()
        ```
    &#39;&#39;&#39;
    try:
        if self.model_name == None:
            info = self.method.get_display_info()
            for i in range(len(info)):
                if info[i][&#39;serial&#39;]==self.serial:
                    self.model_name = info[i]
    except:
        pass
    return {
        &#39;name&#39;:self.name,
        &#39;model&#39;:self.model,
        &#39;model_name&#39;: self.model_name,
        &#39;serial&#39;:self.serial,
        &#39;manufacturer&#39;: self.manufacturer,
        &#39;manufacturer_id&#39;: self.manufacturer_id,
        &#39;method&#39;: self.method,
        &#39;index&#39;: self.index
    }</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.Monitor.is_active"><code class="name flex">
<span>def <span class="ident">is_active</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Attempts to retrieve the brightness for this display. If it works the display is deemed active</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>bool</code></dt>
<dd>True means active, False means inactive</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

primary = sbc.windows.Monitor(0)
if primary.is_active():
    primary.set_brightness(50)
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def is_active(self):
    &#39;&#39;&#39;
    Attempts to retrieve the brightness for this display. If it works the display is deemed active

    Returns:
        bool: True means active, False means inactive

    Example:
        ```python
        import screen_brightness_control as sbc

        primary = sbc.windows.Monitor(0)
        if primary.is_active():
            primary.set_brightness(50)
        ```
    &#39;&#39;&#39;
    try:
        self.get_brightness()
        return True
    except:
        return False</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.Monitor.set_brightness"><code class="name flex">
<span>def <span class="ident">set_brightness</span></span>(<span>self, *args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Sets the brightness for this display</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>args</code></strong> :&ensp;<code>tuple</code></dt>
<dd>passed directly to this monitor's brightness method</dd>
<dt><strong><code>kwargs</code></strong> :&ensp;<code>dict</code></dt>
<dd>passed directly to this monitor's brightness method (the <code>display</code> kwarg is always overwritten)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>int</code></dt>
<dd>from 0 to 100</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

# set the brightness of the primary monitor to 50%
primary = sbc.windows.Monitor(0)
primary_brightness = primary.set_brightness(50)
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_brightness(self, *args, **kwargs):
    &#39;&#39;&#39;
    Sets the brightness for this display

    Args:
        args (tuple): passed directly to this monitor&#39;s brightness method
        kwargs (dict): passed directly to this monitor&#39;s brightness method (the `display` kwarg is always overwritten)

    Returns:
        int: from 0 to 100

    Example:
        ```python
        import screen_brightness_control as sbc

        # set the brightness of the primary monitor to 50%
        primary = sbc.windows.Monitor(0)
        primary_brightness = primary.set_brightness(50)
        ```
    &#39;&#39;&#39;
    kwargs[&#39;display&#39;] = self.serial
    return self.method.set_brightness(*args, **kwargs)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="screen_brightness_control.windows.VCP"><code class="flex name class">
<span>class <span class="ident">VCP</span></span>
</code></dt>
<dd>
<div class="desc"><p>Collection of screen brightness related methods using the DDC/CI commands</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class VCP:
    &#39;&#39;&#39;Collection of screen brightness related methods using the DDC/CI commands&#39;&#39;&#39;
    _MONITORENUMPROC = WINFUNCTYPE(BOOL, HMONITOR, HDC, POINTER(RECT), LPARAM)
    class _PHYSICAL_MONITOR(Structure):
        &#39;&#39;&#39;internal class, do not call&#39;&#39;&#39;
        _fields_ = [(&#39;handle&#39;, HANDLE),
                    (&#39;description&#39;, WCHAR * 128)]

    def iter_physical_monitors():
        &#39;&#39;&#39;
        A generator to iterate through all physical monitors and then close them again afterwards, yielding their handles.
        It is not recommended to use this function unless you are familiar with `ctypes` and `windll`

        Raises:
            ctypes.WinError: upon failure to enumerate through the monitors

        Example:
            ```python
            import screen_brightness_control as sbc

            for monitor in sbc.windows.VCP.iter_physical_monitors():
                print(sbc.windows.VCP.get_monitor_caps(monitor))
            ```
        &#39;&#39;&#39;
        def callback(hmonitor, hdc, lprect, lparam):
            monitors.append(HMONITOR(hmonitor))
            return True

        monitors = []
        if not windll.user32.EnumDisplayMonitors(None, None, VCP._MONITORENUMPROC(callback), None):
            raise WinError(&#39;EnumDisplayMonitors failed&#39;)
        for monitor in monitors:
            # Get physical monitor count
            count = DWORD()
            if not windll.dxva2.GetNumberOfPhysicalMonitorsFromHMONITOR(monitor, byref(count)):
                raise WinError()
            if count.value&gt;0:
                # Get physical monitor handles
                physical_array = (VCP._PHYSICAL_MONITOR * count.value)()
                if not windll.dxva2.GetPhysicalMonitorsFromHMONITOR(monitor, count.value, physical_array):
                    raise WinError()
                for item in physical_array:
                    yield item.handle
                    windll.dxva2.DestroyPhysicalMonitor(item.handle)
    def filter_displays(display, *args):
        &#39;&#39;&#39;
        Searches through the information for all detected displays and attempts to return the info matching the value given.
        Will attempt to match against index, name, model and serial

        Args:
            display (str or int): what you are searching for. Can be serial number, name, model number or index of the display
            args (tuple): [*Optional*] if `args` isn&#39;t empty the function searches through args[0]. Otherwise it searches through the return of `VCP.get_display_info()`

        Raises:
            IndexError: if the display value is an int and an `IndexError` occurs when using it as a list index
            LookupError: if the display, as a str, does not have a match

        Returns:
            dict

        Example:
            ```python
            import screen_brightness_control as sbc

            search = &#39;BNQ78A7&#39;
            match = sbc.windows.VCP.filter_displays(search)
            print(match)
            # EG output: {&#39;name&#39;: &#39;BenQ BNQ78A7&#39;, &#39;model&#39;: &#39;BNQ78A7&#39;, ... }
            ```
        &#39;&#39;&#39;
        if len(args)==1:
            info = args[0]
        else:
            info = VCP.get_display_info()
        if type(display) is int:
            return info[display]
        else:
            for i in info:
                if display in (i[&#39;serial&#39;], i[&#39;model&#39;], i[&#39;name&#39;]):
                    return i
            raise LookupError(&#39;could not find matching display&#39;)
    def get_display_info(*args):
        &#39;&#39;&#39;
        Returns a dictionary of info about all detected monitors or a selection of monitors

        Args:
            args (tuple): [*Optional*] a variable list of monitors. Pass in a monitor&#39;s name/serial/model/index and only the information corresponding to these monitors will be returned

        Returns:
            list: list of dicts if `args` is empty or there are multiple values passed in `args`
            dict: if one value was passed through `args` and it matched a known monitor

        Example:
            ```python
            import screen_brightness_control as sbc

            # get the information about all monitors
            vcp_info = sbc.windows.VCP.get_display_info()
            print(vcp_info)
            # EG output: [{&#39;name&#39;: &#39;BenQ BNQ78A7&#39;, &#39;model&#39;: &#39;BNQ78A7&#39;, ... }, {&#39;name&#39;: &#39;Dell DEL405E&#39;, &#39;model&#39;: &#39;DEL405E&#39;, ... }]

            # get information about a monitor with this specific model
            bnq_info = sbc.windows.VCP.get_display_info(&#39;BNQ78A7&#39;)
            # EG output: {&#39;name&#39;: &#39;BenQ BNQ78A7&#39;, &#39;model&#39;: &#39;BNQ78A7&#39;, ... }

            # get information about 2 specific monitors at the same time
            sbc.windows.VCP.get_display_info(&#39;DEL405E&#39;, &#39;BNQ78A7&#39;)
            # EG output: [{&#39;name&#39;: &#39;Dell DEL405E&#39;, &#39;model&#39;: &#39;DEL405E&#39;, ... }, {&#39;name&#39;: &#39;BenQ BNQ78A7&#39;, &#39;model&#39;: &#39;BNQ78A7&#39;, ... }]
            ```
        &#39;&#39;&#39;
        info = []
        try:
            monitors_enum = win32api.EnumDisplayMonitors()
            monitors = [win32api.GetMonitorInfo(i[0]) for i in monitors_enum]
            monitors = [win32api.EnumDisplayDevices(i[&#39;Device&#39;], 0, 1).DeviceID for i in monitors]
            a=0
            for ms in monitors:
                m = ms.split(&#39;#&#39;)
                serial = m[2]
                model = m[1]

                man_id = model[:3]
                manufacturer = _monitor_brand_lookup(man_id)
                manufacturer = &#39;Unknown&#39; if manufacturer==None else manufacturer

                tmp = {&#39;name&#39;:f&#39;{manufacturer} {model}&#39;, &#39;model&#39;:model, &#39;model_name&#39;: None, &#39;serial&#39;:serial, &#39;manufacturer&#39;: manufacturer, &#39;manufacturer_id&#39;: man_id , &#39;index&#39;: a, &#39;method&#39;: VCP}
                info.append(tmp)
                a+=1
        except:
            pass
        if len(args)&gt;0:
            try:
                info = [VCP.filter_displays(i, info) for i in args]
                return info[0] if len(info)==1 else info
            except:
                pass
        return info
    def get_monitor_caps(monitor):
        &#39;&#39;&#39;
        Fetches and returns the VCP capabilities string of a monitor.
        This function takes anywhere from 1-2 seconds to run

        Args:
            monitor: a monitor handle as returned by `VCP.iter_physical_monitors()`

        Returns:
            str: a string of the monitor&#39;s capabilities

        Examples:
            ```python
            import screen_brightness_control as sbc

            for monitor in sbc.windows.VCP.iter_physical_monitors():
                print(sbc.windows.VCP.get_monitor_caps(monitor))
            # EG output: &#39;(prot(monitor)type(LCD)model(GL2450HM)cmds(01 02 03 07 0C F3)vcp(02 04 05 08 0B 0C 10 12 14(04 05 08 0B) 16 18 1A 52 60(01 03 11)62 8D(01 02)AC AE B2 B6 C0 C6 C8 C9 CA(01 02) CC(01 02 03 04 05 06 09 0A 0B 0D 0E 12 14 1A 1E 1F 20)D6(01 05) DF)mswhql(1)mccs_ver(2.1)asset_eep(32)mpu_ver(1.02))&#39;
            ```
        &#39;&#39;&#39;
        caps_string_length = DWORD()
        if not windll.dxva2.GetCapabilitiesStringLength(monitor,ctypes.byref(caps_string_length)):
            return
        caps_string = (ctypes.c_char * caps_string_length.value)()
        if not windll.dxva2.CapabilitiesRequestAndCapabilitiesReply(monitor, caps_string, caps_string_length):
            return
        return caps_string.value.decode(&#39;ASCII&#39;)
    def get_display_names(*args):
        &#39;&#39;&#39;
        Parse the VCP capabilities string of a monitor to get the actual model name of the monitor.
        So instead of this generic panel model (eg: BNQ78A7) it returns the user-friendly version (GL2450HM).
        This function takes a few seconds to run as it calls `VCP.get_monitor_caps()` for each monitor requested

        Args:
            args (tuple): [*Optional*] a variable list of monitors to get the names of, each item must be the monitor&#39;s handle as returned by `VCP.iter_physical_monitors()`

        Returns:
            list: list of strings

        Example:
            ```python
            import screen_brightness_control as sbc

            names = sbc.windows.VCP.get_display_names()
            print(names)
            # EG output: [&#39;GL2450HM&#39;, &#39;U2211H&#39;]

            # Get all the names if a monitor is not None
            names = []
            for monitor in sbc.windows.VCP.iter_physical_monitors():
                if monitor:
                    names.append(
                        sbc.windows.VCP.get_display_names(monitor)
                    )
            print(names)
            # EG output: [&#39;U2211H&#39;]
            ```
        &#39;&#39;&#39;
        names = []
        if len(args)&gt;0:
            monitors = lambda:args
        else:
            monitors = VCP.iter_physical_monitors

        for monitor in monitors():
            key = VCP.get_monitor_caps(monitor)
            cap = key[key.index(&#39;model(&#39;)+6:]
            cap = cap[:cap.index(&#39;)&#39;)]
            names.append(cap)
        return names
    def get_brightness(display=None):
        &#39;&#39;&#39;
        Retrieve the brightness of all connected displays using the `ctypes.windll` API

        Args:
            display (int or str): the specific display you wish to query. Is passed to `VCP.filter_displays` to match to a display

        Returns:
            list: list of ints from 0 to 100 if multiple displays are detected and the `display` kwarg is not set
            int: from 0 to 100 if there is only one display detected or the `display` kwarg is set

        Examples:
            ```python
            import screen_brightness_control as sbc

            # Get the brightness for all detected displays
            current_brightness = sbc.windows.VCP.get_brightness()
            if type(current_brightness) is int:
                print(&#39;There is only one detected display&#39;)
            else:
                print(&#39;There are&#39;, len(current_brightness), &#39;detected displays&#39;)

            # Get the brightness for the primary display
            primary_brightness = sbc.windows.VCP.get_brightness(display = 0)

            # Get the brightness for a secondary display
            secondary_brightness = sbc.windows.VCP.get_brightness(display = 1)

            # Get the brightness for a display with the model &#39;BNQ78A7&#39;
            benq_brightness = sbc.windows.VCP.get_brightness(display = &#39;BNQ78A7&#39;)
            ```
        &#39;&#39;&#39;
        values = []
        for m in VCP.iter_physical_monitors():
            cur_out = DWORD()
            if windll.dxva2.GetVCPFeatureAndVCPFeatureReply(HANDLE(m), BYTE(0x10), None, byref(cur_out), None):
                values.append(cur_out.value)
            del(cur_out)

        if display!=None:
            display = VCP.filter_displays(display)
            values = [values[display[&#39;index&#39;]]]

        return values[0] if len(values)==1 else values
    def set_brightness(value, display=None, no_return=False):
        &#39;&#39;&#39;
        Sets the brightness for all connected displays using the `ctypes.windll` API

        Args:
            display (int or str): the specific display you wish to query. Is passed to `VCP.filter_displays` to match to a display
            no_return (bool): if set to `True` this function will return `None`

        Returns:
            The result of `VCP.get_brightness()` (with the same `display` kwarg) if `no_return` is not set

        Examples:
            ```python
            import screen_brightness_control as sbc

            # Set the brightness for all detected displays to 50%
            sbc.windows.VCP.set_brightness(50)

            # Set the brightness for the primary display to 75%
            sbc.windows.VCP.set_brightness(75, display = 0)

            # Set the brightness for a secondary display to 25%
            sbc.windows.VCP.set_brightness(25, display = 1)

            # Set the brightness for a display with the model &#39;BNQ78A7&#39; to 100%
            sbc.windows.VCP.set_brightness(100, display = &#39;BNQ78A7&#39;)
            ```
        &#39;&#39;&#39;
        if display!=None:
            display = VCP.filter_displays(display)
            display = display[&#39;index&#39;]
        loops = 0
        for m in VCP.iter_physical_monitors():
            if display==None or (display == loops):
                windll.dxva2.SetVCPFeature(HANDLE(m), BYTE(0x10), DWORD(value))
            loops+=1
        return VCP.get_brightness(display=display) if not no_return else None</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="screen_brightness_control.windows.VCP.filter_displays"><code class="name flex">
<span>def <span class="ident">filter_displays</span></span>(<span>display, *args)</span>
</code></dt>
<dd>
<div class="desc"><p>Searches through the information for all detected displays and attempts to return the info matching the value given.
Will attempt to match against index, name, model and serial</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>display</code></strong> :&ensp;<code>str</code> or <code>int</code></dt>
<dd>what you are searching for. Can be serial number, name, model number or index of the display</dd>
<dt><strong><code>args</code></strong> :&ensp;<code>tuple</code></dt>
<dd>[<em>Optional</em>] if <code>args</code> isn't empty the function searches through args[0]. Otherwise it searches through the return of <code><a title="screen_brightness_control.windows.VCP.get_display_info" href="#screen_brightness_control.windows.VCP.get_display_info">VCP.get_display_info()</a></code></dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>IndexError</code></dt>
<dd>if the display value is an int and an <code>IndexError</code> occurs when using it as a list index</dd>
<dt><code>LookupError</code></dt>
<dd>if the display, as a str, does not have a match</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>dict</p>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

search = 'BNQ78A7'
match = sbc.windows.VCP.filter_displays(search)
print(match)
# EG output: {'name': 'BenQ BNQ78A7', 'model': 'BNQ78A7', ... }
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def filter_displays(display, *args):
    &#39;&#39;&#39;
    Searches through the information for all detected displays and attempts to return the info matching the value given.
    Will attempt to match against index, name, model and serial

    Args:
        display (str or int): what you are searching for. Can be serial number, name, model number or index of the display
        args (tuple): [*Optional*] if `args` isn&#39;t empty the function searches through args[0]. Otherwise it searches through the return of `VCP.get_display_info()`

    Raises:
        IndexError: if the display value is an int and an `IndexError` occurs when using it as a list index
        LookupError: if the display, as a str, does not have a match

    Returns:
        dict

    Example:
        ```python
        import screen_brightness_control as sbc

        search = &#39;BNQ78A7&#39;
        match = sbc.windows.VCP.filter_displays(search)
        print(match)
        # EG output: {&#39;name&#39;: &#39;BenQ BNQ78A7&#39;, &#39;model&#39;: &#39;BNQ78A7&#39;, ... }
        ```
    &#39;&#39;&#39;
    if len(args)==1:
        info = args[0]
    else:
        info = VCP.get_display_info()
    if type(display) is int:
        return info[display]
    else:
        for i in info:
            if display in (i[&#39;serial&#39;], i[&#39;model&#39;], i[&#39;name&#39;]):
                return i
        raise LookupError(&#39;could not find matching display&#39;)</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.VCP.get_brightness"><code class="name flex">
<span>def <span class="ident">get_brightness</span></span>(<span>display=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Retrieve the brightness of all connected displays using the <code>ctypes.windll</code> API</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>display</code></strong> :&ensp;<code>int</code> or <code>str</code></dt>
<dd>the specific display you wish to query. Is passed to <code><a title="screen_brightness_control.windows.VCP.filter_displays" href="#screen_brightness_control.windows.VCP.filter_displays">VCP.filter_displays()</a></code> to match to a display</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>list of ints from 0 to 100 if multiple displays are detected and the <code>display</code> kwarg is not set</dd>
<dt><code>int</code></dt>
<dd>from 0 to 100 if there is only one display detected or the <code>display</code> kwarg is set</dd>
</dl>
<h2 id="examples">Examples</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

# Get the brightness for all detected displays
current_brightness = sbc.windows.VCP.get_brightness()
if type(current_brightness) is int:
    print('There is only one detected display')
else:
    print('There are', len(current_brightness), 'detected displays')

# Get the brightness for the primary display
primary_brightness = sbc.windows.VCP.get_brightness(display = 0)

# Get the brightness for a secondary display
secondary_brightness = sbc.windows.VCP.get_brightness(display = 1)

# Get the brightness for a display with the model 'BNQ78A7'
benq_brightness = sbc.windows.VCP.get_brightness(display = 'BNQ78A7')
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_brightness(display=None):
    &#39;&#39;&#39;
    Retrieve the brightness of all connected displays using the `ctypes.windll` API

    Args:
        display (int or str): the specific display you wish to query. Is passed to `VCP.filter_displays` to match to a display

    Returns:
        list: list of ints from 0 to 100 if multiple displays are detected and the `display` kwarg is not set
        int: from 0 to 100 if there is only one display detected or the `display` kwarg is set

    Examples:
        ```python
        import screen_brightness_control as sbc

        # Get the brightness for all detected displays
        current_brightness = sbc.windows.VCP.get_brightness()
        if type(current_brightness) is int:
            print(&#39;There is only one detected display&#39;)
        else:
            print(&#39;There are&#39;, len(current_brightness), &#39;detected displays&#39;)

        # Get the brightness for the primary display
        primary_brightness = sbc.windows.VCP.get_brightness(display = 0)

        # Get the brightness for a secondary display
        secondary_brightness = sbc.windows.VCP.get_brightness(display = 1)

        # Get the brightness for a display with the model &#39;BNQ78A7&#39;
        benq_brightness = sbc.windows.VCP.get_brightness(display = &#39;BNQ78A7&#39;)
        ```
    &#39;&#39;&#39;
    values = []
    for m in VCP.iter_physical_monitors():
        cur_out = DWORD()
        if windll.dxva2.GetVCPFeatureAndVCPFeatureReply(HANDLE(m), BYTE(0x10), None, byref(cur_out), None):
            values.append(cur_out.value)
        del(cur_out)

    if display!=None:
        display = VCP.filter_displays(display)
        values = [values[display[&#39;index&#39;]]]

    return values[0] if len(values)==1 else values</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.VCP.get_display_info"><code class="name flex">
<span>def <span class="ident">get_display_info</span></span>(<span>*args)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns a dictionary of info about all detected monitors or a selection of monitors</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>args</code></strong> :&ensp;<code>tuple</code></dt>
<dd>[<em>Optional</em>] a variable list of monitors. Pass in a monitor's name/serial/model/index and only the information corresponding to these monitors will be returned</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>list of dicts if <code>args</code> is empty or there are multiple values passed in <code>args</code></dd>
<dt><code>dict</code></dt>
<dd>if one value was passed through <code>args</code> and it matched a known monitor</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

# get the information about all monitors
vcp_info = sbc.windows.VCP.get_display_info()
print(vcp_info)
# EG output: [{'name': 'BenQ BNQ78A7', 'model': 'BNQ78A7', ... }, {'name': 'Dell DEL405E', 'model': 'DEL405E', ... }]

# get information about a monitor with this specific model
bnq_info = sbc.windows.VCP.get_display_info('BNQ78A7')
# EG output: {'name': 'BenQ BNQ78A7', 'model': 'BNQ78A7', ... }

# get information about 2 specific monitors at the same time
sbc.windows.VCP.get_display_info('DEL405E', 'BNQ78A7')
# EG output: [{'name': 'Dell DEL405E', 'model': 'DEL405E', ... }, {'name': 'BenQ BNQ78A7', 'model': 'BNQ78A7', ... }]
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_display_info(*args):
    &#39;&#39;&#39;
    Returns a dictionary of info about all detected monitors or a selection of monitors

    Args:
        args (tuple): [*Optional*] a variable list of monitors. Pass in a monitor&#39;s name/serial/model/index and only the information corresponding to these monitors will be returned

    Returns:
        list: list of dicts if `args` is empty or there are multiple values passed in `args`
        dict: if one value was passed through `args` and it matched a known monitor

    Example:
        ```python
        import screen_brightness_control as sbc

        # get the information about all monitors
        vcp_info = sbc.windows.VCP.get_display_info()
        print(vcp_info)
        # EG output: [{&#39;name&#39;: &#39;BenQ BNQ78A7&#39;, &#39;model&#39;: &#39;BNQ78A7&#39;, ... }, {&#39;name&#39;: &#39;Dell DEL405E&#39;, &#39;model&#39;: &#39;DEL405E&#39;, ... }]

        # get information about a monitor with this specific model
        bnq_info = sbc.windows.VCP.get_display_info(&#39;BNQ78A7&#39;)
        # EG output: {&#39;name&#39;: &#39;BenQ BNQ78A7&#39;, &#39;model&#39;: &#39;BNQ78A7&#39;, ... }

        # get information about 2 specific monitors at the same time
        sbc.windows.VCP.get_display_info(&#39;DEL405E&#39;, &#39;BNQ78A7&#39;)
        # EG output: [{&#39;name&#39;: &#39;Dell DEL405E&#39;, &#39;model&#39;: &#39;DEL405E&#39;, ... }, {&#39;name&#39;: &#39;BenQ BNQ78A7&#39;, &#39;model&#39;: &#39;BNQ78A7&#39;, ... }]
        ```
    &#39;&#39;&#39;
    info = []
    try:
        monitors_enum = win32api.EnumDisplayMonitors()
        monitors = [win32api.GetMonitorInfo(i[0]) for i in monitors_enum]
        monitors = [win32api.EnumDisplayDevices(i[&#39;Device&#39;], 0, 1).DeviceID for i in monitors]
        a=0
        for ms in monitors:
            m = ms.split(&#39;#&#39;)
            serial = m[2]
            model = m[1]

            man_id = model[:3]
            manufacturer = _monitor_brand_lookup(man_id)
            manufacturer = &#39;Unknown&#39; if manufacturer==None else manufacturer

            tmp = {&#39;name&#39;:f&#39;{manufacturer} {model}&#39;, &#39;model&#39;:model, &#39;model_name&#39;: None, &#39;serial&#39;:serial, &#39;manufacturer&#39;: manufacturer, &#39;manufacturer_id&#39;: man_id , &#39;index&#39;: a, &#39;method&#39;: VCP}
            info.append(tmp)
            a+=1
    except:
        pass
    if len(args)&gt;0:
        try:
            info = [VCP.filter_displays(i, info) for i in args]
            return info[0] if len(info)==1 else info
        except:
            pass
    return info</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.VCP.get_display_names"><code class="name flex">
<span>def <span class="ident">get_display_names</span></span>(<span>*args)</span>
</code></dt>
<dd>
<div class="desc"><p>Parse the VCP capabilities string of a monitor to get the actual model name of the monitor.
So instead of this generic panel model (eg: BNQ78A7) it returns the user-friendly version (GL2450HM).
This function takes a few seconds to run as it calls <code><a title="screen_brightness_control.windows.VCP.get_monitor_caps" href="#screen_brightness_control.windows.VCP.get_monitor_caps">VCP.get_monitor_caps()</a></code> for each monitor requested</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>args</code></strong> :&ensp;<code>tuple</code></dt>
<dd>[<em>Optional</em>] a variable list of monitors to get the names of, each item must be the monitor's handle as returned by <code><a title="screen_brightness_control.windows.VCP.iter_physical_monitors" href="#screen_brightness_control.windows.VCP.iter_physical_monitors">VCP.iter_physical_monitors()</a></code></dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>list of strings</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

names = sbc.windows.VCP.get_display_names()
print(names)
# EG output: ['GL2450HM', 'U2211H']

# Get all the names if a monitor is not None
names = []
for monitor in sbc.windows.VCP.iter_physical_monitors():
    if monitor:
        names.append(
            sbc.windows.VCP.get_display_names(monitor)
        )
print(names)
# EG output: ['U2211H']
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_display_names(*args):
    &#39;&#39;&#39;
    Parse the VCP capabilities string of a monitor to get the actual model name of the monitor.
    So instead of this generic panel model (eg: BNQ78A7) it returns the user-friendly version (GL2450HM).
    This function takes a few seconds to run as it calls `VCP.get_monitor_caps()` for each monitor requested

    Args:
        args (tuple): [*Optional*] a variable list of monitors to get the names of, each item must be the monitor&#39;s handle as returned by `VCP.iter_physical_monitors()`

    Returns:
        list: list of strings

    Example:
        ```python
        import screen_brightness_control as sbc

        names = sbc.windows.VCP.get_display_names()
        print(names)
        # EG output: [&#39;GL2450HM&#39;, &#39;U2211H&#39;]

        # Get all the names if a monitor is not None
        names = []
        for monitor in sbc.windows.VCP.iter_physical_monitors():
            if monitor:
                names.append(
                    sbc.windows.VCP.get_display_names(monitor)
                )
        print(names)
        # EG output: [&#39;U2211H&#39;]
        ```
    &#39;&#39;&#39;
    names = []
    if len(args)&gt;0:
        monitors = lambda:args
    else:
        monitors = VCP.iter_physical_monitors

    for monitor in monitors():
        key = VCP.get_monitor_caps(monitor)
        cap = key[key.index(&#39;model(&#39;)+6:]
        cap = cap[:cap.index(&#39;)&#39;)]
        names.append(cap)
    return names</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.VCP.get_monitor_caps"><code class="name flex">
<span>def <span class="ident">get_monitor_caps</span></span>(<span>monitor)</span>
</code></dt>
<dd>
<div class="desc"><p>Fetches and returns the VCP capabilities string of a monitor.
This function takes anywhere from 1-2 seconds to run</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>monitor</code></strong></dt>
<dd>a monitor handle as returned by <code><a title="screen_brightness_control.windows.VCP.iter_physical_monitors" href="#screen_brightness_control.windows.VCP.iter_physical_monitors">VCP.iter_physical_monitors()</a></code></dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>str</code></dt>
<dd>a string of the monitor's capabilities</dd>
</dl>
<h2 id="examples">Examples</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

for monitor in sbc.windows.VCP.iter_physical_monitors():
    print(sbc.windows.VCP.get_monitor_caps(monitor))
# EG output: '(prot(monitor)type(LCD)model(GL2450HM)cmds(01 02 03 07 0C F3)vcp(02 04 05 08 0B 0C 10 12 14(04 05 08 0B) 16 18 1A 52 60(01 03 11)62 8D(01 02)AC AE B2 B6 C0 C6 C8 C9 CA(01 02) CC(01 02 03 04 05 06 09 0A 0B 0D 0E 12 14 1A 1E 1F 20)D6(01 05) DF)mswhql(1)mccs_ver(2.1)asset_eep(32)mpu_ver(1.02))'
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_monitor_caps(monitor):
    &#39;&#39;&#39;
    Fetches and returns the VCP capabilities string of a monitor.
    This function takes anywhere from 1-2 seconds to run

    Args:
        monitor: a monitor handle as returned by `VCP.iter_physical_monitors()`

    Returns:
        str: a string of the monitor&#39;s capabilities

    Examples:
        ```python
        import screen_brightness_control as sbc

        for monitor in sbc.windows.VCP.iter_physical_monitors():
            print(sbc.windows.VCP.get_monitor_caps(monitor))
        # EG output: &#39;(prot(monitor)type(LCD)model(GL2450HM)cmds(01 02 03 07 0C F3)vcp(02 04 05 08 0B 0C 10 12 14(04 05 08 0B) 16 18 1A 52 60(01 03 11)62 8D(01 02)AC AE B2 B6 C0 C6 C8 C9 CA(01 02) CC(01 02 03 04 05 06 09 0A 0B 0D 0E 12 14 1A 1E 1F 20)D6(01 05) DF)mswhql(1)mccs_ver(2.1)asset_eep(32)mpu_ver(1.02))&#39;
        ```
    &#39;&#39;&#39;
    caps_string_length = DWORD()
    if not windll.dxva2.GetCapabilitiesStringLength(monitor,ctypes.byref(caps_string_length)):
        return
    caps_string = (ctypes.c_char * caps_string_length.value)()
    if not windll.dxva2.CapabilitiesRequestAndCapabilitiesReply(monitor, caps_string, caps_string_length):
        return
    return caps_string.value.decode(&#39;ASCII&#39;)</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.VCP.iter_physical_monitors"><code class="name flex">
<span>def <span class="ident">iter_physical_monitors</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>A generator to iterate through all physical monitors and then close them again afterwards, yielding their handles.
It is not recommended to use this function unless you are familiar with <code>ctypes</code> and <code>windll</code></p>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>ctypes.WinError</code></dt>
<dd>upon failure to enumerate through the monitors</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

for monitor in sbc.windows.VCP.iter_physical_monitors():
    print(sbc.windows.VCP.get_monitor_caps(monitor))
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def iter_physical_monitors():
    &#39;&#39;&#39;
    A generator to iterate through all physical monitors and then close them again afterwards, yielding their handles.
    It is not recommended to use this function unless you are familiar with `ctypes` and `windll`

    Raises:
        ctypes.WinError: upon failure to enumerate through the monitors

    Example:
        ```python
        import screen_brightness_control as sbc

        for monitor in sbc.windows.VCP.iter_physical_monitors():
            print(sbc.windows.VCP.get_monitor_caps(monitor))
        ```
    &#39;&#39;&#39;
    def callback(hmonitor, hdc, lprect, lparam):
        monitors.append(HMONITOR(hmonitor))
        return True

    monitors = []
    if not windll.user32.EnumDisplayMonitors(None, None, VCP._MONITORENUMPROC(callback), None):
        raise WinError(&#39;EnumDisplayMonitors failed&#39;)
    for monitor in monitors:
        # Get physical monitor count
        count = DWORD()
        if not windll.dxva2.GetNumberOfPhysicalMonitorsFromHMONITOR(monitor, byref(count)):
            raise WinError()
        if count.value&gt;0:
            # Get physical monitor handles
            physical_array = (VCP._PHYSICAL_MONITOR * count.value)()
            if not windll.dxva2.GetPhysicalMonitorsFromHMONITOR(monitor, count.value, physical_array):
                raise WinError()
            for item in physical_array:
                yield item.handle
                windll.dxva2.DestroyPhysicalMonitor(item.handle)</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.VCP.set_brightness"><code class="name flex">
<span>def <span class="ident">set_brightness</span></span>(<span>value, display=None, no_return=False)</span>
</code></dt>
<dd>
<div class="desc"><p>Sets the brightness for all connected displays using the <code>ctypes.windll</code> API</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>display</code></strong> :&ensp;<code>int</code> or <code>str</code></dt>
<dd>the specific display you wish to query. Is passed to <code><a title="screen_brightness_control.windows.VCP.filter_displays" href="#screen_brightness_control.windows.VCP.filter_displays">VCP.filter_displays()</a></code> to match to a display</dd>
<dt><strong><code>no_return</code></strong> :&ensp;<code>bool</code></dt>
<dd>if set to <code>True</code> this function will return <code>None</code></dd>
</dl>
<h2 id="returns">Returns</h2>
<p>The result of <code><a title="screen_brightness_control.windows.VCP.get_brightness" href="#screen_brightness_control.windows.VCP.get_brightness">VCP.get_brightness()</a></code> (with the same <code>display</code> kwarg) if <code>no_return</code> is not set</p>
<h2 id="examples">Examples</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

# Set the brightness for all detected displays to 50%
sbc.windows.VCP.set_brightness(50)

# Set the brightness for the primary display to 75%
sbc.windows.VCP.set_brightness(75, display = 0)

# Set the brightness for a secondary display to 25%
sbc.windows.VCP.set_brightness(25, display = 1)

# Set the brightness for a display with the model 'BNQ78A7' to 100%
sbc.windows.VCP.set_brightness(100, display = 'BNQ78A7')
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_brightness(value, display=None, no_return=False):
    &#39;&#39;&#39;
    Sets the brightness for all connected displays using the `ctypes.windll` API

    Args:
        display (int or str): the specific display you wish to query. Is passed to `VCP.filter_displays` to match to a display
        no_return (bool): if set to `True` this function will return `None`

    Returns:
        The result of `VCP.get_brightness()` (with the same `display` kwarg) if `no_return` is not set

    Examples:
        ```python
        import screen_brightness_control as sbc

        # Set the brightness for all detected displays to 50%
        sbc.windows.VCP.set_brightness(50)

        # Set the brightness for the primary display to 75%
        sbc.windows.VCP.set_brightness(75, display = 0)

        # Set the brightness for a secondary display to 25%
        sbc.windows.VCP.set_brightness(25, display = 1)

        # Set the brightness for a display with the model &#39;BNQ78A7&#39; to 100%
        sbc.windows.VCP.set_brightness(100, display = &#39;BNQ78A7&#39;)
        ```
    &#39;&#39;&#39;
    if display!=None:
        display = VCP.filter_displays(display)
        display = display[&#39;index&#39;]
    loops = 0
    for m in VCP.iter_physical_monitors():
        if display==None or (display == loops):
            windll.dxva2.SetVCPFeature(HANDLE(m), BYTE(0x10), DWORD(value))
        loops+=1
    return VCP.get_brightness(display=display) if not no_return else None</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="screen_brightness_control.windows.WMI"><code class="flex name class">
<span>class <span class="ident">WMI</span></span>
</code></dt>
<dd>
<div class="desc"><p>collection of screen brightness related methods using the WMI API</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class WMI:
    &#39;&#39;&#39;collection of screen brightness related methods using the WMI API&#39;&#39;&#39;
    def _get_display_index(display, *args):
        &#39;&#39;&#39;internal function, do not call&#39;&#39;&#39;
        if len(args)==1:
            info = args[0]
        else:
            info = WMI.get_display_info()
        a = 0
        for i in info:
            if display in (i[&#39;serial&#39;], i[&#39;model&#39;], i[&#39;name&#39;]):
                return a
            a+=1
        return None
    def get_display_info(*args):
        &#39;&#39;&#39;
        Returns a dictionary of info about all detected monitors

        Args:
            monitor (str or int): [*Optional*] the monitor to return info about. Pass in the serial number, name, model or index

        Returns:
            list: list of dictonaries
            dict: one dictionary if a monitor is specified

        Example:
            ```python
            import screen_brightness_control as sbc

            info = sbc.windows.WMI.get_display_info()
            for i in info:
                print(&#39;================&#39;)
                for key, value in i.items():
                    print(key, &#39;:&#39;, value)

            # get information about the first WMI addressable monitor
            primary_info = sbc.windows.WMI.get_display_info(0)

            # get information about a monitor with a specific name
            benq_info = sbc.windows.WMI.get_display_info(&#39;BenQ BNQ78A7&#39;)
            ```
        &#39;&#39;&#39;
        #WMI calls don&#39;t work in new threads so we have to run this check
        if threading.current_thread() != threading.main_thread():
            pythoncom.CoInitialize()
        info = []
        a = 0
        try:
            monitors = wmi.WMI(namespace=&#39;wmi&#39;).WmiMonitorBrightness()
            for m in monitors:
                instance = m.InstanceName.split(&#39;\\&#39;)
                serial = instance[-1]
                model = instance[1]

                man_id = model[:3]
                manufacturer = _monitor_brand_lookup(man_id)
                manufacturer = &#39;Unknown&#39; if manufacturer==None else manufacturer

                tmp = {&#39;name&#39;:f&#39;{manufacturer} {model}&#39;, &#39;model&#39;:model, &#39;model_name&#39;: None, &#39;serial&#39;:serial, &#39;manufacturer&#39;: manufacturer, &#39;manufacturer_id&#39;: man_id , &#39;index&#39;: a, &#39;method&#39;: WMI}
                info.append(tmp)
                a+=1
        except:
            pass
        if len(args)==1:
            index = WMI._get_display_index(args[0], info)
            if index==None:
                raise LookupError(&#39;display not in list&#39;)
            else:
                info = info[index]
        return info
    def get_display_names():
        &#39;&#39;&#39;
        Returns names of all displays that can be addressed by WMI

        Returns:
            list: list of strings

        Example:
            ```python
            import screen_brightness_control as sbc

            for name in sbc.windows.WMI.get_display_names():
                print(name)
            ```
        &#39;&#39;&#39;
        info = WMI.get_display_info()
        names = [i[&#39;name&#39;] for i in info]
        return names
    def set_brightness(value, display = None, no_return = False):
        &#39;&#39;&#39;
        Sets the display brightness for Windows using WMI

        Args:
            value (int): The percentage to set the brightness to
            display (int or str): The index display you wish to set the brightness for OR the model of the display, as returned by self.get_display_names
            no_return (bool): if True, this function returns None, otherwise it returns the result of `WMI.get_brightness()`

        Returns:
            int: from 0 to 100 if only one display&#39;s brightness is requested
            list: list of integers if multiple displays are requested
            None: if `no_return` is set to `True`

        Raises:
            LookupError: if the given display cannot be found

        Example:
            ```python
            import screen_brightness_control as sbc

            # set brightness of WMI addressable monitors to 50%
            sbc.windows.WMI.set_brightness(50)

            # set the primary display brightness to 75%
            sbc.windows.WMI.set_brightness(75, display = 0)

            # set the brightness of a named monitor to 25%
            sbc.windows.WMI.set_brightness(25, display = &#39;BenQ BNQ78A7&#39;)
            ```
        &#39;&#39;&#39;
        #WMI calls don&#39;t work in new threads so we have to run this check
        if threading.current_thread() != threading.main_thread():
            pythoncom.CoInitialize()

        brightness_method = wmi.WMI(namespace=&#39;wmi&#39;).WmiMonitorBrightnessMethods()
        if display!=None:
            if type(display) is str:
                display = WMI._get_display_index(display)
                if display == None:
                    raise LookupError(&#39;display name not found&#39;)
            brightness_method = [brightness_method[display]]
        for method in brightness_method:
            method.WmiSetBrightness(value,0)
        return WMI.get_brightness(display=display) if not no_return else None
    def get_brightness(display = None):
        &#39;&#39;&#39;
        Returns the current display brightness using the `wmi` API

        Args:
            display (int): The index display you wish to get the brightness of OR the model of that display

        Returns:
            int: from 0 to 100 if only one display&#39;s brightness is requested
            list: list of integers if multiple displays are requested

        Raises:
            LookupError: if the given display cannot be found

        Example:
            ```python
            import screen_brightness_control as sbc

            # get brightness of all WMI addressable monitors
            current_brightness = sbc.windows.WMI.get_brightness()
            if type(current_brightness) is int:
                print(&#39;There is only one detected display&#39;)
            else:
                print(&#39;There are&#39;, len(current_brightness), &#39;detected displays&#39;)

            # get the primary display brightness
            primary_brightness = sbc.windows.WMI.get_brightness(display = 0)

            # get the brightness of a named monitor
            benq_brightness = sbc.windows.WMI.get_brightness(display = &#39;BenQ BNQ78A7&#39;)
            ```
        &#39;&#39;&#39;
        #WMI calls don&#39;t work in new threads so we have to run this check
        if threading.current_thread() != threading.main_thread():
            pythoncom.CoInitialize()
        brightness_method = wmi.WMI(namespace=&#39;wmi&#39;).WmiMonitorBrightness()
        values = [i.CurrentBrightness for i in brightness_method]
        if display!=None:
            if type(display) is str:
                display = WMI._get_display_index(display)
                if display == None:
                    raise LookupError(&#39;display name not found&#39;)
            values = [values[display]]
        values = values[0] if len(values)==1 else values
        return values</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="screen_brightness_control.windows.WMI.get_brightness"><code class="name flex">
<span>def <span class="ident">get_brightness</span></span>(<span>display=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the current display brightness using the <code>wmi</code> API</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>display</code></strong> :&ensp;<code>int</code></dt>
<dd>The index display you wish to get the brightness of OR the model of that display</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>int</code></dt>
<dd>from 0 to 100 if only one display's brightness is requested</dd>
<dt><code>list</code></dt>
<dd>list of integers if multiple displays are requested</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>LookupError</code></dt>
<dd>if the given display cannot be found</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

# get brightness of all WMI addressable monitors
current_brightness = sbc.windows.WMI.get_brightness()
if type(current_brightness) is int:
    print('There is only one detected display')
else:
    print('There are', len(current_brightness), 'detected displays')

# get the primary display brightness
primary_brightness = sbc.windows.WMI.get_brightness(display = 0)

# get the brightness of a named monitor
benq_brightness = sbc.windows.WMI.get_brightness(display = 'BenQ BNQ78A7')
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_brightness(display = None):
    &#39;&#39;&#39;
    Returns the current display brightness using the `wmi` API

    Args:
        display (int): The index display you wish to get the brightness of OR the model of that display

    Returns:
        int: from 0 to 100 if only one display&#39;s brightness is requested
        list: list of integers if multiple displays are requested

    Raises:
        LookupError: if the given display cannot be found

    Example:
        ```python
        import screen_brightness_control as sbc

        # get brightness of all WMI addressable monitors
        current_brightness = sbc.windows.WMI.get_brightness()
        if type(current_brightness) is int:
            print(&#39;There is only one detected display&#39;)
        else:
            print(&#39;There are&#39;, len(current_brightness), &#39;detected displays&#39;)

        # get the primary display brightness
        primary_brightness = sbc.windows.WMI.get_brightness(display = 0)

        # get the brightness of a named monitor
        benq_brightness = sbc.windows.WMI.get_brightness(display = &#39;BenQ BNQ78A7&#39;)
        ```
    &#39;&#39;&#39;
    #WMI calls don&#39;t work in new threads so we have to run this check
    if threading.current_thread() != threading.main_thread():
        pythoncom.CoInitialize()
    brightness_method = wmi.WMI(namespace=&#39;wmi&#39;).WmiMonitorBrightness()
    values = [i.CurrentBrightness for i in brightness_method]
    if display!=None:
        if type(display) is str:
            display = WMI._get_display_index(display)
            if display == None:
                raise LookupError(&#39;display name not found&#39;)
        values = [values[display]]
    values = values[0] if len(values)==1 else values
    return values</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.WMI.get_display_info"><code class="name flex">
<span>def <span class="ident">get_display_info</span></span>(<span>*args)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns a dictionary of info about all detected monitors</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>monitor</code></strong> :&ensp;<code>str</code> or <code>int</code></dt>
<dd>[<em>Optional</em>] the monitor to return info about. Pass in the serial number, name, model or index</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>list of dictonaries</dd>
<dt><code>dict</code></dt>
<dd>one dictionary if a monitor is specified</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

info = sbc.windows.WMI.get_display_info()
for i in info:
    print('================')
    for key, value in i.items():
        print(key, ':', value)

# get information about the first WMI addressable monitor
primary_info = sbc.windows.WMI.get_display_info(0)

# get information about a monitor with a specific name
benq_info = sbc.windows.WMI.get_display_info('BenQ BNQ78A7')
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_display_info(*args):
    &#39;&#39;&#39;
    Returns a dictionary of info about all detected monitors

    Args:
        monitor (str or int): [*Optional*] the monitor to return info about. Pass in the serial number, name, model or index

    Returns:
        list: list of dictonaries
        dict: one dictionary if a monitor is specified

    Example:
        ```python
        import screen_brightness_control as sbc

        info = sbc.windows.WMI.get_display_info()
        for i in info:
            print(&#39;================&#39;)
            for key, value in i.items():
                print(key, &#39;:&#39;, value)

        # get information about the first WMI addressable monitor
        primary_info = sbc.windows.WMI.get_display_info(0)

        # get information about a monitor with a specific name
        benq_info = sbc.windows.WMI.get_display_info(&#39;BenQ BNQ78A7&#39;)
        ```
    &#39;&#39;&#39;
    #WMI calls don&#39;t work in new threads so we have to run this check
    if threading.current_thread() != threading.main_thread():
        pythoncom.CoInitialize()
    info = []
    a = 0
    try:
        monitors = wmi.WMI(namespace=&#39;wmi&#39;).WmiMonitorBrightness()
        for m in monitors:
            instance = m.InstanceName.split(&#39;\\&#39;)
            serial = instance[-1]
            model = instance[1]

            man_id = model[:3]
            manufacturer = _monitor_brand_lookup(man_id)
            manufacturer = &#39;Unknown&#39; if manufacturer==None else manufacturer

            tmp = {&#39;name&#39;:f&#39;{manufacturer} {model}&#39;, &#39;model&#39;:model, &#39;model_name&#39;: None, &#39;serial&#39;:serial, &#39;manufacturer&#39;: manufacturer, &#39;manufacturer_id&#39;: man_id , &#39;index&#39;: a, &#39;method&#39;: WMI}
            info.append(tmp)
            a+=1
    except:
        pass
    if len(args)==1:
        index = WMI._get_display_index(args[0], info)
        if index==None:
            raise LookupError(&#39;display not in list&#39;)
        else:
            info = info[index]
    return info</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.WMI.get_display_names"><code class="name flex">
<span>def <span class="ident">get_display_names</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns names of all displays that can be addressed by WMI</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>list of strings</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

for name in sbc.windows.WMI.get_display_names():
    print(name)
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_display_names():
    &#39;&#39;&#39;
    Returns names of all displays that can be addressed by WMI

    Returns:
        list: list of strings

    Example:
        ```python
        import screen_brightness_control as sbc

        for name in sbc.windows.WMI.get_display_names():
            print(name)
        ```
    &#39;&#39;&#39;
    info = WMI.get_display_info()
    names = [i[&#39;name&#39;] for i in info]
    return names</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.WMI.set_brightness"><code class="name flex">
<span>def <span class="ident">set_brightness</span></span>(<span>value, display=None, no_return=False)</span>
</code></dt>
<dd>
<div class="desc"><p>Sets the display brightness for Windows using WMI</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>value</code></strong> :&ensp;<code>int</code></dt>
<dd>The percentage to set the brightness to</dd>
<dt><strong><code>display</code></strong> :&ensp;<code>int</code> or <code>str</code></dt>
<dd>The index display you wish to set the brightness for OR the model of the display, as returned by self.get_display_names</dd>
<dt><strong><code>no_return</code></strong> :&ensp;<code>bool</code></dt>
<dd>if True, this function returns None, otherwise it returns the result of <code><a title="screen_brightness_control.windows.WMI.get_brightness" href="#screen_brightness_control.windows.WMI.get_brightness">WMI.get_brightness()</a></code></dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>int</code></dt>
<dd>from 0 to 100 if only one display's brightness is requested</dd>
<dt><code>list</code></dt>
<dd>list of integers if multiple displays are requested</dd>
<dt><code>None</code></dt>
<dd>if <code>no_return</code> is set to <code>True</code></dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>LookupError</code></dt>
<dd>if the given display cannot be found</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

# set brightness of WMI addressable monitors to 50%
sbc.windows.WMI.set_brightness(50)

# set the primary display brightness to 75%
sbc.windows.WMI.set_brightness(75, display = 0)

# set the brightness of a named monitor to 25%
sbc.windows.WMI.set_brightness(25, display = 'BenQ BNQ78A7')
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_brightness(value, display = None, no_return = False):
    &#39;&#39;&#39;
    Sets the display brightness for Windows using WMI

    Args:
        value (int): The percentage to set the brightness to
        display (int or str): The index display you wish to set the brightness for OR the model of the display, as returned by self.get_display_names
        no_return (bool): if True, this function returns None, otherwise it returns the result of `WMI.get_brightness()`

    Returns:
        int: from 0 to 100 if only one display&#39;s brightness is requested
        list: list of integers if multiple displays are requested
        None: if `no_return` is set to `True`

    Raises:
        LookupError: if the given display cannot be found

    Example:
        ```python
        import screen_brightness_control as sbc

        # set brightness of WMI addressable monitors to 50%
        sbc.windows.WMI.set_brightness(50)

        # set the primary display brightness to 75%
        sbc.windows.WMI.set_brightness(75, display = 0)

        # set the brightness of a named monitor to 25%
        sbc.windows.WMI.set_brightness(25, display = &#39;BenQ BNQ78A7&#39;)
        ```
    &#39;&#39;&#39;
    #WMI calls don&#39;t work in new threads so we have to run this check
    if threading.current_thread() != threading.main_thread():
        pythoncom.CoInitialize()

    brightness_method = wmi.WMI(namespace=&#39;wmi&#39;).WmiMonitorBrightnessMethods()
    if display!=None:
        if type(display) is str:
            display = WMI._get_display_index(display)
            if display == None:
                raise LookupError(&#39;display name not found&#39;)
        brightness_method = [brightness_method[display]]
    for method in brightness_method:
        method.WmiSetBrightness(value,0)
    return WMI.get_brightness(display=display) if not no_return else None</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="screen_brightness_control" href="index.html">screen_brightness_control</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="screen_brightness_control.windows.get_brightness" href="#screen_brightness_control.windows.get_brightness">get_brightness</a></code></li>
<li><code><a title="screen_brightness_control.windows.list_monitors" href="#screen_brightness_control.windows.list_monitors">list_monitors</a></code></li>
<li><code><a title="screen_brightness_control.windows.list_monitors_info" href="#screen_brightness_control.windows.list_monitors_info">list_monitors_info</a></code></li>
<li><code><a title="screen_brightness_control.windows.set_brightness" href="#screen_brightness_control.windows.set_brightness">set_brightness</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="screen_brightness_control.windows.Monitor" href="#screen_brightness_control.windows.Monitor">Monitor</a></code></h4>
<ul class="two-column">
<li><code><a title="screen_brightness_control.windows.Monitor.get_brightness" href="#screen_brightness_control.windows.Monitor.get_brightness">get_brightness</a></code></li>
<li><code><a title="screen_brightness_control.windows.Monitor.get_info" href="#screen_brightness_control.windows.Monitor.get_info">get_info</a></code></li>
<li><code><a title="screen_brightness_control.windows.Monitor.index" href="#screen_brightness_control.windows.Monitor.index">index</a></code></li>
<li><code><a title="screen_brightness_control.windows.Monitor.is_active" href="#screen_brightness_control.windows.Monitor.is_active">is_active</a></code></li>
<li><code><a title="screen_brightness_control.windows.Monitor.manufacturer" href="#screen_brightness_control.windows.Monitor.manufacturer">manufacturer</a></code></li>
<li><code><a title="screen_brightness_control.windows.Monitor.manufacturer_id" href="#screen_brightness_control.windows.Monitor.manufacturer_id">manufacturer_id</a></code></li>
<li><code><a title="screen_brightness_control.windows.Monitor.method" href="#screen_brightness_control.windows.Monitor.method">method</a></code></li>
<li><code><a title="screen_brightness_control.windows.Monitor.model" href="#screen_brightness_control.windows.Monitor.model">model</a></code></li>
<li><code><a title="screen_brightness_control.windows.Monitor.model_name" href="#screen_brightness_control.windows.Monitor.model_name">model_name</a></code></li>
<li><code><a title="screen_brightness_control.windows.Monitor.name" href="#screen_brightness_control.windows.Monitor.name">name</a></code></li>
<li><code><a title="screen_brightness_control.windows.Monitor.serial" href="#screen_brightness_control.windows.Monitor.serial">serial</a></code></li>
<li><code><a title="screen_brightness_control.windows.Monitor.set_brightness" href="#screen_brightness_control.windows.Monitor.set_brightness">set_brightness</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="screen_brightness_control.windows.VCP" href="#screen_brightness_control.windows.VCP">VCP</a></code></h4>
<ul class="">
<li><code><a title="screen_brightness_control.windows.VCP.filter_displays" href="#screen_brightness_control.windows.VCP.filter_displays">filter_displays</a></code></li>
<li><code><a title="screen_brightness_control.windows.VCP.get_brightness" href="#screen_brightness_control.windows.VCP.get_brightness">get_brightness</a></code></li>
<li><code><a title="screen_brightness_control.windows.VCP.get_display_info" href="#screen_brightness_control.windows.VCP.get_display_info">get_display_info</a></code></li>
<li><code><a title="screen_brightness_control.windows.VCP.get_display_names" href="#screen_brightness_control.windows.VCP.get_display_names">get_display_names</a></code></li>
<li><code><a title="screen_brightness_control.windows.VCP.get_monitor_caps" href="#screen_brightness_control.windows.VCP.get_monitor_caps">get_monitor_caps</a></code></li>
<li><code><a title="screen_brightness_control.windows.VCP.iter_physical_monitors" href="#screen_brightness_control.windows.VCP.iter_physical_monitors">iter_physical_monitors</a></code></li>
<li><code><a title="screen_brightness_control.windows.VCP.set_brightness" href="#screen_brightness_control.windows.VCP.set_brightness">set_brightness</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="screen_brightness_control.windows.WMI" href="#screen_brightness_control.windows.WMI">WMI</a></code></h4>
<ul class="">
<li><code><a title="screen_brightness_control.windows.WMI.get_brightness" href="#screen_brightness_control.windows.WMI.get_brightness">get_brightness</a></code></li>
<li><code><a title="screen_brightness_control.windows.WMI.get_display_info" href="#screen_brightness_control.windows.WMI.get_display_info">get_display_info</a></code></li>
<li><code><a title="screen_brightness_control.windows.WMI.get_display_names" href="#screen_brightness_control.windows.WMI.get_display_names">get_display_names</a></code></li>
<li><code><a title="screen_brightness_control.windows.WMI.set_brightness" href="#screen_brightness_control.windows.WMI.set_brightness">set_brightness</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.1</a>.</p>
</footer>
</body>
</html>
